# AIæœåŠ¡æ¶æ„é‡æ„PRD

## ğŸ“‹ é¡¹ç›®æ¦‚è¿°

### èƒŒæ™¯
å½“å‰AIæœåŠ¡æ¶æ„å­˜åœ¨ä»¥ä¸‹æ ¸å¿ƒé—®é¢˜ï¼š
1. **`AIReverseEngineerService.ts`** 524è¡Œï¼ŒèŒè´£æ··ä¹±ï¼Œéš¾ä»¥ç»´æŠ¤
2. **ç¡¬ç¼–ç é—®é¢˜**ï¼šå„APIè·¯ç”±ä¸­ç¡¬ç¼–ç provideré€‰æ‹©ï¼ˆå¦‚`const provider = 'gemini'`ï¼‰
3. **ç¼ºä¹æœåŠ¡å‘ç°**ï¼šAIæœåŠ¡è°ƒç”¨åˆ†æ•£ï¼Œæ— æ³•ç»Ÿä¸€ç®¡ç†å’ŒåŠ¨æ€åˆ‡æ¢
4. **é…ç½®ç®¡ç†æ··ä¹±**ï¼šé‡å¤é€ è½®å­ï¼Œä¸ç°æœ‰æ¨èå¼•æ“åŠŸèƒ½é‡å 
5. **ä»£ç å†—ä½™**ï¼šå¤§é‡é‡å¤çš„providerè°ƒç”¨é€»è¾‘

### ç›®æ ‡
æ„å»º"æ¨èå¼•æ“ + AIæœåŠ¡"åŒå±‚æ¶æ„ï¼Œå®ç°ï¼š
- ğŸ¯ **èŒè´£æ¸…æ™°**ï¼šæ¨èå¼•æ“è´Ÿè´£é€‰æ‹©ï¼ŒAIæœåŠ¡è´Ÿè´£æ‰§è¡Œ
- ğŸ”§ **æœåŠ¡å‘ç°**ï¼šç»Ÿä¸€çš„AIæœåŠ¡æ³¨å†Œã€å‘ç°å’ŒåŠ¨æ€åˆ‡æ¢æœºåˆ¶
- âš™ï¸ **é…ç½®ç»Ÿä¸€**ï¼šåˆ©ç”¨ç°æœ‰é…ç½®æ–‡ä»¶ï¼Œé¿å…é‡å¤é€ è½®å­
- ğŸ“Š **ç›‘æ§ä½“ç³»**ï¼šæ€§èƒ½/æˆæœ¬/è´¨é‡ä¸‰ç»´ç›‘æ§
- ğŸš€ **ä»£ç ç®€åŒ–**ï¼šå‡å°‘é‡å¤ä»£ç ï¼Œæé«˜å¯ç»´æŠ¤æ€§

---

## ğŸ—ï¸ æ¶æ„è®¾è®¡

### 1. æ•´ä½“æ¶æ„

```mermaid
graph TB
    subgraph "åº”ç”¨å±‚"
        A[API Routes] --> B[ä¸šåŠ¡æœåŠ¡å±‚]
    end
    
    subgraph "ä¸šåŠ¡æœåŠ¡å±‚"
        B --> C[AIåæ¨æœåŠ¡]
        B --> D[å•†å“åˆ†ææœåŠ¡]
        B --> E[è§†é¢‘è„šæœ¬æœåŠ¡]
        B --> F[è§†é¢‘ç”ŸæˆæœåŠ¡]
    end
    
    subgraph "AIæœåŠ¡å±‚"
        C --> G[æœåŠ¡å‘ç°æœºåˆ¶]
        D --> G
        E --> G
        F --> G
        
        G --> H[æœåŠ¡æ³¨å†Œè¡¨]
        G --> I[æœåŠ¡å‘ç°å™¨]
        G --> J[æœåŠ¡é€‚é…å™¨]
        
        J --> K[é€šç”¨APIè°ƒç”¨å™¨]
        K --> L[Provideré…ç½®]
    end
    
    subgraph "æ¨èå¼•æ“ï¼ˆä¿æŒç°çŠ¶ï¼‰"
        M[æ¨èå¼•æ“] --> G
    end
    
    subgraph "ç°æœ‰é…ç½®æ–‡ä»¶"
        N[verified-models.json] --> L
        O[ai-config.json] --> L
    end
```

### 2. æ ¸å¿ƒåŸåˆ™

#### 2.1 åˆ©ç”¨ç°æœ‰èµ„æº
- **`verified-models.json`** - ä½œä¸ºprovideré…ç½®çš„åŸºç¡€
- **`ai-config.json`** - æ‰©å±•ä¸šåŠ¡æ¨¡å—é…ç½®
- **æ¨èå¼•æ“** - ç»§ç»­è´Ÿè´£æ¨¡å‹é€‰æ‹©ï¼Œä¸é‡å¤é€ è½®å­

#### 2.2 ç®€åŒ–è®¾è®¡
- **åˆ é™¤å†—ä½™**ï¼šå¤æ‚çš„é…ç½®ç®¡ç†ã€é‡å¤çš„æ¨¡å‹é€‰æ‹©é€»è¾‘
- **ç»Ÿä¸€è°ƒç”¨**ï¼šæŠ½è±¡é€šç”¨çš„APIè°ƒç”¨é€»è¾‘
- **é…ç½®é©±åŠ¨**ï¼šæ‰€æœ‰é…ç½®ä»æ–‡ä»¶è¯»å–ï¼Œæ— ç¡¬ç¼–ç 

#### 2.3 èŒè´£åˆ†ç¦»
- **æ¨èå¼•æ“**ï¼šæ ¹æ®ä»»åŠ¡ç‰¹å¾æ¨èæœ€é€‚åˆçš„æ¨¡å‹
- **æœåŠ¡å‘ç°**ï¼šæ ¹æ®æ¨èç»“æœæ‰¾åˆ°å¯ç”¨çš„AIæœåŠ¡å®ä¾‹
- **æœåŠ¡é€‚é…å™¨**ï¼šç»Ÿä¸€è°ƒç”¨æ¥å£ï¼Œå±è”½providerå·®å¼‚

---

## ğŸš€ å®æ–½è®¡åˆ’

### é˜¶æ®µ1ï¼šç®€åŒ–ç°æœ‰ä»£ç ï¼ˆ1å‘¨ï¼‰
**ç›®æ ‡**ï¼šåˆ é™¤å†—ä½™ä»£ç ï¼Œåˆ©ç”¨ç°æœ‰é…ç½®

**ä»»åŠ¡æ¸…å•**ï¼š
- [ ] ç®€åŒ– `AIConfigManager` - åªç®¡ç†åŸºç¡€é…ç½®ï¼Œä»ç°æœ‰æ–‡ä»¶è¯»å–
- [ ] é‡æ„ `AIServiceAdapter` - æŠ½è±¡é€šç”¨è°ƒç”¨é€»è¾‘ï¼Œå‡å°‘é‡å¤ä»£ç 
- [ ] é›†æˆç°æœ‰é…ç½® - ä» `verified-models.json` è¯»å–providerä¿¡æ¯
- [ ] åˆ é™¤ç¡¬ç¼–ç  - ç§»é™¤æ‰€æœ‰ç¡¬ç¼–ç çš„provideré…ç½®

**éªŒæ”¶æ ‡å‡†**ï¼š
- ä»£ç è¡Œæ•°å‡å°‘50%ä»¥ä¸Š
- æ— ç¡¬ç¼–ç ï¼Œæ‰€æœ‰é…ç½®ä»æ–‡ä»¶è¯»å–
- ä¸ç°æœ‰æ¨èå¼•æ“é›†æˆ

### é˜¶æ®µ2ï¼šæœåŠ¡å‘ç°ä¼˜åŒ–ï¼ˆ1å‘¨ï¼‰
**ç›®æ ‡**ï¼šå®Œå–„æœåŠ¡å‘ç°æœºåˆ¶ï¼Œä¸æ¨èå¼•æ“é›†æˆ

**ä»»åŠ¡æ¸…å•**ï¼š
- [ ] ä¼˜åŒ– `ServiceDiscovery` - ä¸æ¨èå¼•æ“é›†æˆï¼Œä¸é‡å¤é€‰æ‹©é€»è¾‘
- [ ] å®Œå–„ `AIServiceRegistry` - ä»ç°æœ‰é…ç½®è‡ªåŠ¨æ³¨å†ŒæœåŠ¡
- [ ] å®ç°æœåŠ¡é™çº§ - æ”¯æŒå¤šçº§é™çº§ç­–ç•¥
- [ ] æ·»åŠ å¥åº·æ£€æŸ¥ - ç®€å•çš„æœåŠ¡çŠ¶æ€ç›‘æ§

**éªŒæ”¶æ ‡å‡†**ï¼š
- æœåŠ¡å‘ç°ä¸æ¨èå¼•æ“æ— ç¼é›†æˆ
- æ”¯æŒè‡ªåŠ¨æœåŠ¡æ³¨å†Œå’ŒçŠ¶æ€æ›´æ–°
- æ”¯æŒæœåŠ¡é™çº§å’Œå®¹é”™

### é˜¶æ®µ3ï¼šç›‘æ§ä½“ç³»ï¼ˆ1å‘¨ï¼‰
**ç›®æ ‡**ï¼šå»ºç«‹åŸºç¡€ç›‘æ§ä½“ç³»

**ä»»åŠ¡æ¸…å•**ï¼š
- [ ] å®ç° `PerformanceMonitor` - æ”¶é›†æ€§èƒ½æŒ‡æ ‡
- [ ] æ·»åŠ æˆæœ¬ç›‘æ§ - è·Ÿè¸ªAPIè°ƒç”¨æˆæœ¬
- [ ] å®ç°è´¨é‡ç›‘æ§ - åŸºç¡€çš„è´¨é‡è¯„ä¼°
- [ ] åˆ›å»ºç›‘æ§ä»ªè¡¨æ¿ - ç®€å•çš„ç›‘æ§ç•Œé¢

**éªŒæ”¶æ ‡å‡†**ï¼š
- æ”¯æŒæ€§èƒ½ã€æˆæœ¬ã€è´¨é‡ä¸‰ç»´ç›‘æ§
- æä¾›ç›‘æ§æ•°æ®å’Œå‘Šè­¦
- ç›‘æ§ç•Œé¢å¯ç”¨

### é˜¶æ®µ4ï¼šæµ‹è¯•å’Œä¼˜åŒ–ï¼ˆ1å‘¨ï¼‰
**ç›®æ ‡**ï¼šç¡®ä¿ç³»ç»Ÿç¨³å®šæ€§å’Œæ€§èƒ½

**ä»»åŠ¡æ¸…å•**ï¼š
- [ ] å®Œå–„å•å…ƒæµ‹è¯• - è¦†ç›–ç‡90%+
- [ ] å®ç°é›†æˆæµ‹è¯• - ç«¯åˆ°ç«¯æµ‹è¯•
- [ ] æ€§èƒ½æµ‹è¯• - å‹åŠ›æµ‹è¯•å’Œä¼˜åŒ–
- [ ] æ–‡æ¡£å®Œå–„ - æ›´æ–°æŠ€æœ¯æ–‡æ¡£

**éªŒæ”¶æ ‡å‡†**ï¼š
- æ‰€æœ‰æµ‹è¯•é€šè¿‡
- æ€§èƒ½æŒ‡æ ‡è¾¾åˆ°é¢„æœŸ
- æ–‡æ¡£å®Œæ•´å‡†ç¡®

---

## ğŸ“Š é¢„æœŸæ”¶ç›Š

### ä»£ç è´¨é‡
- **ä»£ç è¡Œæ•°**ï¼šå‡å°‘50%ä»¥ä¸Š
- **é‡å¤ä»£ç **ï¼šæ¶ˆé™¤90%ä»¥ä¸Šçš„é‡å¤
- **å¯ç»´æŠ¤æ€§**ï¼šæ˜¾è‘—æå‡

### æ€§èƒ½æå‡
- **å“åº”æ—¶é—´**ï¼šå‡å°‘30%
- **å¼€å‘æ•ˆç‡**ï¼šæ–°åŠŸèƒ½å¼€å‘æ•ˆç‡æå‡40%
- **é”™è¯¯ç‡**ï¼šå‡å°‘60%

### æ¶æ„æ¸…æ™°
- **èŒè´£åˆ†ç¦»**ï¼šæ¨èå¼•æ“è´Ÿè´£é€‰æ‹©ï¼ŒAIæœåŠ¡è´Ÿè´£æ‰§è¡Œ
- **é…ç½®ç»Ÿä¸€**ï¼šåˆ©ç”¨ç°æœ‰é…ç½®æ–‡ä»¶ï¼Œé¿å…é‡å¤
- **æ‰©å±•æ€§**ï¼šæ–°å¢provideråªéœ€æ›´æ–°é…ç½®æ–‡ä»¶

---

## ğŸ”§ æŠ€æœ¯å®ç°ç»†èŠ‚

### 1. é…ç½®æ–‡ä»¶ç»“æ„

#### verified-models.jsonï¼ˆç°æœ‰ï¼‰
```json
[
  {
    "id": "gemini-2.5-flash",
    "name": "Gemini 2.5 Flash",
    "provider": "Google",
    "verified": true,
    "status": "verified"
  }
]
```

#### ai-config.jsonï¼ˆæ‰©å±•ï¼‰
```json
{
  "providers": {
    "gemini": {
      "apiKey": "GEMINI_API_KEY",
      "baseUrl": "https://generativelanguage.googleapis.com",
      "timeout": 30000
    }
  },
  "businessModules": {
    "ai-reverse-engineer": {
      "maxLatency": 10000,
      "maxCost": 0.01
    }
  }
}
```

### 2. æœåŠ¡å‘ç°æµç¨‹

```typescript
// 1. æ¨èå¼•æ“é€‰æ‹©æ¨¡å‹
const recommendation = await recommendRank({
  scenario: 'task->model',
  task: { taskType: 'ai-reverse-engineer' }
})

// 2. æœåŠ¡å‘ç°æ‰¾åˆ°å¯¹åº”æœåŠ¡
const service = await serviceDiscovery.findService(recommendation.chosen.id)

// 3. æœåŠ¡é€‚é…å™¨è°ƒç”¨
const adapter = new AIServiceAdapter(service)
const result = await adapter.call(prompt)
```

### 3. é€šç”¨APIè°ƒç”¨å™¨

```typescript
class UniversalAPICaller {
  async call(provider: string, model: string, prompt: string, options: CallOptions) {
    const config = this.getProviderConfig(provider)
    const endpoint = this.getEndpoint(provider, model)
    const headers = this.getHeaders(provider, config.apiKey)
    const body = this.buildRequestBody(provider, model, prompt, options)
    
    return this.executeRequest(endpoint, headers, body)
  }
}
```

---

## ğŸ¯ éªŒæ”¶æ ‡å‡†

### åŠŸèƒ½éªŒæ”¶
- [ ] æœåŠ¡å‘ç°æœºåˆ¶æ­£å¸¸å·¥ä½œ
- [ ] ä¸æ¨èå¼•æ“æ— ç¼é›†æˆ
- [ ] æ”¯æŒæœåŠ¡é™çº§å’Œå®¹é”™
- [ ] é…ç½®ä»æ–‡ä»¶è¯»å–ï¼Œæ— ç¡¬ç¼–ç 

### æ€§èƒ½éªŒæ”¶
- [ ] ä»£ç è¡Œæ•°å‡å°‘50%ä»¥ä¸Š
- [ ] å“åº”æ—¶é—´å‡å°‘30%
- [ ] é‡å¤ä»£ç å‡å°‘90%ä»¥ä¸Š

### è´¨é‡éªŒæ”¶
- [ ] å•å…ƒæµ‹è¯•è¦†ç›–ç‡90%+
- [ ] é›†æˆæµ‹è¯•é€šè¿‡
- [ ] ä»£ç å®¡æŸ¥é€šè¿‡
- [ ] æ–‡æ¡£å®Œæ•´å‡†ç¡®

---

## ğŸ“‹ æ€»ç»“

è¿™ä¸ªé‡æ„æ–¹æ¡ˆå°†AIæœåŠ¡ä»æ··ä¹±çš„å•ä½“æ¶æ„å‡çº§ä¸ºæ¸…æ™°çš„å¾®æœåŠ¡æ¶æ„ï¼Œé€šè¿‡ï¼š

1. **åˆ©ç”¨ç°æœ‰èµ„æº** - ä¸é‡å¤é€ è½®å­
2. **ç®€åŒ–è®¾è®¡** - åˆ é™¤å†—ä½™ä»£ç 
3. **ç»Ÿä¸€é…ç½®** - ä»æ–‡ä»¶è¯»å–ï¼Œæ— ç¡¬ç¼–ç 
4. **èŒè´£åˆ†ç¦»** - æ¨èå¼•æ“é€‰æ‹©ï¼ŒAIæœåŠ¡æ‰§è¡Œ

å®ç°ä»£ç è´¨é‡ã€æ€§èƒ½å’Œå¯ç»´æŠ¤æ€§çš„å…¨é¢æå‡ã€‚


'use client'

import { useState, useEffect } from 'react'
import { Card, CardContent, CardDescription, CardHeader, CardTitle } from '@/components/ui/card'
import { Button } from '@/components/ui/button'
import { Input } from '@/components/ui/input'
import { Label } from '@/components/ui/label'
import { Textarea } from '@/components/ui/textarea'
import { Select, SelectContent, SelectItem, SelectTrigger, SelectValue } from '@/components/ui/select'
import { Badge } from '@/components/ui/badge'
import { Tabs, TabsContent, TabsList, TabsTrigger } from '@/components/ui/tabs'
import { Plus, Edit, Trash2, Package, Palette, BarChart3, RefreshCw, Database, Brain, Upload, Settings, Users, Search, MessageSquare } from 'lucide-react'

interface Product {
  id: string
  name: string
  description: string
  category: string
  subcategory: string
  sellingPoints: string[]
  skuImages: string[]
  targetCountries: string[]
  createdAt: string
}

interface Style {
  id: string
  name: string
  description: string
  category: string
  subcategory: string
  tone: string
  scriptStructure: any
  visualStyle: any
  targetAudience: any
  productId: string
  productName: string
  isActive: boolean
  createdAt: string
}

interface User {
  id: string
  email: string
  name: string
  role: string
  isActive: boolean
  createdAt: string
  _count: {
    videos: number
  }
}

interface PainPoint {
  id: string
  productId: string
  platform: string
  productName: string
  painPoints: string[]
  severity: string
  frequency: number
  sentiment: string
  createdAt: string
  product: {
    id: string
    name: string
    category: string
  }
  _count: {
    comments: number
  }
}


export default function AdminPage() {
  const [activeTab, setActiveTab] = useState('products')
  const [products, setProducts] = useState<Product[]>([])
  const [styles, setStyles] = useState<Style[]>([])
  const [users, setUsers] = useState<User[]>([])
  const [painPoints, setPainPoints] = useState<PainPoint[]>([])
  const [showProductForm, setShowProductForm] = useState(false)
  const [showStyleForm, setShowStyleForm] = useState(false)
  const [showUserForm, setShowUserForm] = useState(false)
  const [showPainPointForm, setShowPainPointForm] = useState(false)
  const [editingProduct, setEditingProduct] = useState<Product | null>(null)
  const [editingStyle, setEditingStyle] = useState<Style | null>(null)
  const [editingUser, setEditingUser] = useState<User | null>(null)
  const [isSyncing, setIsSyncing] = useState(false)
  const [syncResult, setSyncResult] = useState<any>(null)
  const [selectedProduct, setSelectedProduct] = useState<any>(null)
  const [showProductDetail, setShowProductDetail] = useState(false)
  const [showBulkUpload, setShowBulkUpload] = useState(false)
  const [bulkUploadFile, setBulkUploadFile] = useState<File | null>(null)
  const [bulkUploading, setBulkUploading] = useState(false)
  const [showRankingTuning, setShowRankingTuning] = useState(false)
  const [showScrapingModal, setShowScrapingModal] = useState(false)
  const [scrapingConfig, setScrapingConfig] = useState({
    platform: '',
    keywords: '',
    maxComments: 100,
    dateRange: ''
  })
  
  // è°ƒå‚çŠ¶æ€
  const [tuningConfig, setTuningConfig] = useState({
    coarseRanking: {
      relevance: 30,
      quality: 25,
      diversity: 25,
      recency: 20
    },
    fineRanking: {
      userPreference: 30,
      businessValue: 30,
      technicalQuality: 25,
      marketTrend: 15
    }
  })
  
  // ç­›é€‰å™¨çŠ¶æ€
  const [filters, setFilters] = useState({
    dateRange: '7d',
    product: 'all',
    platform: 'all',
    template: 'all'
  })

  // æ•°æ®åŠ è½½
  useEffect(() => {
    loadProducts()
    loadStyles()
    loadUsers()
    loadPainPoints()
  }, [])

  const loadProducts = async () => {
    // æ¨¡æ‹Ÿå•†å“æ•°æ®
    setProducts([
      {
        id: '1',
        name: 'æ— çº¿è“ç‰™è€³æœº',
        description: 'é«˜å“è´¨æ— çº¿è“ç‰™è€³æœºï¼Œé™å™ªåŠŸèƒ½å¼ºå¤§',
        category: 'ç”µå­äº§å“',
        subcategory: 'éŸ³é¢‘è®¾å¤‡',
        sellingPoints: ['ä¸»åŠ¨é™å™ªæŠ€æœ¯', '30å°æ—¶ç»­èˆª', 'å¿«é€Ÿå……ç”µ', 'é˜²æ°´è®¾è®¡'],
        skuImages: ['https://example.com/earphone1.jpg', 'https://example.com/earphone2.jpg'],
        targetCountries: ['US', 'UK', 'DE', 'JP'],
        createdAt: '2024-01-01'
      },
      {
        id: '2',
        name: 'æ™ºèƒ½æ‰‹è¡¨',
        description: 'å¤šåŠŸèƒ½æ™ºèƒ½æ‰‹è¡¨ï¼Œå¥åº·ç›‘æµ‹ä¸“å®¶',
        category: 'ç”µå­äº§å“',
        subcategory: 'å¯ç©¿æˆ´è®¾å¤‡',
        sellingPoints: ['24å°æ—¶å¿ƒç‡ç›‘æµ‹', 'ç¡çœ è´¨é‡åˆ†æ', 'è¿åŠ¨æ¨¡å¼è¿½è¸ª', 'é˜²æ°´è®¾è®¡'],
        skuImages: ['https://example.com/watch1.jpg', 'https://example.com/watch2.jpg'],
        targetCountries: ['US', 'CA', 'AU'],
        createdAt: '2024-01-02'
      }
    ])
  }

  const loadStyles = async () => {
    // æ¨¡æ‹Ÿé£æ ¼æ•°æ®
    setStyles([
      {
        id: '1',
        name: 'ç§‘æŠ€æ„Ÿé£æ ¼',
        description: 'é€‚åˆç”µå­äº§å“çš„ç§‘æŠ€æ„Ÿè§†é¢‘é£æ ¼',
        category: 'ç”µå­äº§å“',
        subcategory: 'ç§‘æŠ€',
        tone: 'professional',
        scriptStructure: { opening: 'äº§å“ç‰¹å†™', middle: 'åŠŸèƒ½æ¼”ç¤º', ending: 'å“ç‰Œå±•ç¤º' },
        visualStyle: { colorScheme: 'è“è‰²ç§‘æŠ€é£', lighting: 'æ˜äº®æ¸…æ™°', cameraAngle: 'å¤šè§’åº¦å±•ç¤º' },
        targetAudience: { age: '25-45', gender: 'all', interests: ['ç§‘æŠ€', 'ç”µå­äº§å“'] },
        productId: '1',
        productName: 'æ— çº¿è“ç‰™è€³æœº',
        isActive: true,
        createdAt: '2024-01-01'
      },
      {
        id: '2',
        name: 'æ—¶å°šç¾å¦†é£æ ¼',
        description: 'é€‚åˆç¾å¦†æŠ¤è‚¤äº§å“çš„æ—¶å°šé£æ ¼',
        category: 'ç¾å¦†æŠ¤è‚¤',
        subcategory: 'æ—¶å°š',
        tone: 'elegant',
        scriptStructure: { opening: 'æ¨¡ç‰¹å±•ç¤º', middle: 'äº§å“ä½¿ç”¨', ending: 'æ•ˆæœå¯¹æ¯”' },
        visualStyle: { colorScheme: 'ç²‰è‰²æ¸©æŸ”é£', lighting: 'æŸ”å’Œè‡ªç„¶å…‰', cameraAngle: 'ç‰¹å†™é•œå¤´' },
        targetAudience: { age: '18-35', gender: 'female', interests: ['ç¾å¦†', 'æŠ¤è‚¤', 'æ—¶å°š'] },
        productId: '2',
        productName: 'æ™ºèƒ½æ‰‹è¡¨',
        isActive: true,
        createdAt: '2024-01-02'
      }
    ])
  }

  const loadUsers = async () => {
    try {
      const response = await fetch('/api/admin/users')
      const result = await response.json()
      if (result.success) {
        setUsers(result.data)
      }
    } catch (error) {
      console.error('åŠ è½½ç”¨æˆ·æ•°æ®å¤±è´¥:', error)
      // æ¨¡æ‹Ÿç”¨æˆ·æ•°æ®
      setUsers([
        {
          id: '1',
          email: 'admin@example.com',
          name: 'ç®¡ç†å‘˜',
          role: 'admin',
          isActive: true,
          createdAt: '2024-01-01',
          _count: { videos: 0 }
        },
        {
          id: '2',
          email: 'user@example.com',
          name: 'æ™®é€šç”¨æˆ·',
          role: 'viewer',
          isActive: true,
          createdAt: '2024-01-02',
          _count: { videos: 5 }
        }
      ])
    }
  }

  const loadPainPoints = async () => {
    try {
      const response = await fetch('/api/admin/pain-points')
      const result = await response.json()
      if (result.success) {
        setPainPoints(result.data.painPoints)
      }
    } catch (error) {
      console.error('åŠ è½½ç—›ç‚¹æ•°æ®å¤±è´¥:', error)
      // æ¨¡æ‹Ÿç—›ç‚¹æ•°æ®
      setPainPoints([
        {
          id: '1',
          productId: '1',
          platform: 'shopee',
          productName: 'æ— çº¿è“ç‰™è€³æœº',
          painPoints: ['éŸ³è´¨ä¸å¤Ÿæ¸…æ™°', 'ç”µæ± ç»­èˆªçŸ­', 'è¿æ¥ä¸ç¨³å®š'],
          severity: 'high',
          frequency: 15,
          sentiment: 'negative',
          createdAt: '2024-01-01',
          product: {
            id: '1',
            name: 'æ— çº¿è“ç‰™è€³æœº',
            category: 'ç”µå­äº§å“'
          },
          _count: { comments: 25 }
        },
        {
          id: '2',
          productId: '2',
          platform: 'tiktok',
          productName: 'æ™ºèƒ½æ‰‹è¡¨',
          painPoints: ['è¡¨å¸¦å®¹æ˜“æ–­è£‚', 'å±å¹•å®¹æ˜“åˆ®èŠ±', 'å……ç”µé€Ÿåº¦æ…¢'],
          severity: 'medium',
          frequency: 8,
          sentiment: 'negative',
          createdAt: '2024-01-02',
          product: {
            id: '2',
            name: 'æ™ºèƒ½æ‰‹è¡¨',
            category: 'ç”µå­äº§å“'
          },
          _count: { comments: 12 }
        }
      ])
    }
  }

  const loadUserSubmissions = async () => {
    try {
      const response = await fetch('/api/admin/user-submissions')
      const result = await response.json()
      if (result.success) {
        setUserSubmissions(result.data.submissions)
      }
    } catch (error) {
      console.error('åŠ è½½ç”¨æˆ·æäº¤æ•°æ®å¤±è´¥:', error)
      // æ¨¡æ‹Ÿç”¨æˆ·æäº¤æ•°æ®
      setUserSubmissions([
        {
          id: '1',
          userId: 'user1',
          type: 'style',
          targetId: null,
          data: JSON.stringify({
            name: 'ç§‘æŠ€æ„Ÿäº§å“å±•ç¤ºé£æ ¼',
            description: 'åŸºäºç”¨æˆ·è§†é¢‘åˆ†æç”Ÿæˆçš„ç§‘æŠ€æ„Ÿé£æ ¼',
            category: 'ç§‘æŠ€äº§å“',
            subcategory: 'ç”µå­äº§å“',
            tone: 'ä¸“ä¸š',
            scriptStructure: {
              opening: 'äº§å“ç‰¹å†™å±•ç¤º',
              middle: 'åŠŸèƒ½æ¼”ç¤ºå’Œä½¿ç”¨åœºæ™¯',
              ending: 'å“ç‰Œlogoå’Œè´­ä¹°å¼•å¯¼'
            },
            visualStyle: {
              colorScheme: 'è“è‰²ç§‘æŠ€é£',
              lighting: 'æ˜äº®æ¸…æ™°',
              cameraAngle: 'å¤šè§’åº¦å±•ç¤º',
              effects: 'ç§‘æŠ€æ„Ÿç‰¹æ•ˆ'
            },
            targetAudience: '25-45å²ï¼Œç§‘æŠ€çˆ±å¥½è€…'
          }),
          source: 'user_video_analysis',
          sourceVideoId: 'video1',
          sourceUrl: 'https://example.com/video1',
          status: 'pending',
          isApplied: false,
          createdAt: '2024-01-01T10:00:00Z',
          updatedAt: '2024-01-01T10:00:00Z'
        },
        {
          id: '2',
          userId: 'user2',
          type: 'product',
          targetId: '1',
          data: JSON.stringify({
            sellingPoints: ['ä¸»åŠ¨é™å™ªæŠ€æœ¯', '30å°æ—¶ç»­èˆª', 'å¿«é€Ÿå……ç”µ', 'é˜²æ°´è®¾è®¡', 'AIæ™ºèƒ½è°ƒéŸ³'],
            description: 'é«˜å“è´¨æ— çº¿è“ç‰™è€³æœºï¼Œé™å™ªåŠŸèƒ½å¼ºå¤§ï¼Œæ”¯æŒAIæ™ºèƒ½è°ƒéŸ³'
          }),
          originalData: JSON.stringify({
            sellingPoints: ['ä¸»åŠ¨é™å™ªæŠ€æœ¯', '30å°æ—¶ç»­èˆª', 'å¿«é€Ÿå……ç”µ', 'é˜²æ°´è®¾è®¡'],
            description: 'é«˜å“è´¨æ— çº¿è“ç‰™è€³æœºï¼Œé™å™ªåŠŸèƒ½å¼ºå¤§'
          }),
          source: 'user_analysis',
          sourceVideoId: 'video2',
          status: 'pending',
          isApplied: false,
          createdAt: '2024-01-02T14:30:00Z',
          updatedAt: '2024-01-02T14:30:00Z'
        }
      ])
    }
  }

  const handleEditProduct = (product: Product) => {
    setEditingProduct(product)
    setShowProductForm(true)
  }

  const handleEditStyle = (style: Style) => {
    setEditingStyle(style)
    setShowStyleForm(true)
  }

  const handleDeleteProduct = (id: string) => {
    setProducts(products.filter(p => p.id !== id))
  }

  const handleDeleteStyle = (id: string) => {
    setStyles(styles.filter(s => s.id !== id))
  }

  const handleEditUser = (user: User) => {
    setEditingUser(user)
    setShowUserForm(true)
  }

  const handleReviewSubmission = async (submissionId: string, status: 'approved' | 'rejected', reviewNotes?: string) => {
    try {
      const response = await fetch(`/api/admin/user-submissions/${submissionId}`, {
        method: 'PUT',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({
          status,
          reviewNotes,
          reviewedBy: 'admin' // è¿™é‡Œåº”è¯¥æ˜¯å½“å‰ç®¡ç†å‘˜ID
        })
      })

      const result = await response.json()
      if (result.success) {
        // æ›´æ–°æœ¬åœ°çŠ¶æ€
        setUserSubmissions(prev => 
          prev.map(sub => 
            sub.id === submissionId 
              ? { ...sub, status, reviewNotes, reviewedAt: new Date().toISOString() }
              : sub
          )
        )
        setShowSubmissionDetail(false)
        setSelectedSubmission(null)
      }
    } catch (error) {
      console.error('å®¡æ ¸æäº¤å¤±è´¥:', error)
    }
  }

  const handleViewSubmission = (submission: UserSubmission) => {
    setSelectedSubmission(submission)
    setShowSubmissionDetail(true)
  }

  const handleDeleteUser = async (id: string) => {
    try {
      const response = await fetch(`/api/admin/users/${id}`, {
        method: 'DELETE'
      })
      const result = await response.json()
      if (result.success) {
        setUsers(users.filter(u => u.id !== id))
        alert('ç”¨æˆ·åˆ é™¤æˆåŠŸ')
      } else {
        alert(`åˆ é™¤å¤±è´¥ï¼š${result.error}`)
      }
    } catch (error) {
      console.error('åˆ é™¤ç”¨æˆ·å¤±è´¥:', error)
      alert('åˆ é™¤ç”¨æˆ·å¤±è´¥')
    }
  }

  const handleCreateUser = async (userData: any) => {
    try {
      const response = await fetch('/api/admin/users', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify(userData)
      })
      const result = await response.json()
      if (result.success) {
        setUsers([result.data, ...users])
        setShowUserForm(false)
        alert('ç”¨æˆ·åˆ›å»ºæˆåŠŸ')
      } else {
        alert(`åˆ›å»ºå¤±è´¥ï¼š${result.error}`)
      }
    } catch (error) {
      console.error('åˆ›å»ºç”¨æˆ·å¤±è´¥:', error)
      alert('åˆ›å»ºç”¨æˆ·å¤±è´¥')
    }
  }

  const handleStartScraping = async (productId: string) => {
    try {
      const response = await fetch('/api/admin/scraping', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({
          productId,
          platform: scrapingConfig.platform,
          keywords: scrapingConfig.keywords,
          maxComments: scrapingConfig.maxComments,
          dateRange: scrapingConfig.dateRange
        })
      })
      const result = await response.json()
      if (result.success) {
        alert('çˆ¬å–ä»»åŠ¡åˆ›å»ºæˆåŠŸ')
        setShowScrapingModal(false)
        loadPainPoints() // é‡æ–°åŠ è½½ç—›ç‚¹æ•°æ®
      } else {
        alert(`åˆ›å»ºçˆ¬å–ä»»åŠ¡å¤±è´¥ï¼š${result.error}`)
      }
    } catch (error) {
      console.error('åˆ›å»ºçˆ¬å–ä»»åŠ¡å¤±è´¥:', error)
      alert('åˆ›å»ºçˆ¬å–ä»»åŠ¡å¤±è´¥')
    }
  }

  const handleAIAnalyze = async (painPointId: string) => {
    try {
      const response = await fetch('/api/admin/ai-analyze', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({
          painPointId,
          comments: [] // è¿™é‡Œåº”è¯¥ä¼ å…¥å®é™…çš„è¯„è®ºæ•°æ®
        })
      })
      const result = await response.json()
      if (result.success) {
        alert('AIåˆ†æå®Œæˆ')
        loadPainPoints() // é‡æ–°åŠ è½½ç—›ç‚¹æ•°æ®
      } else {
        alert(`AIåˆ†æå¤±è´¥ï¼š${result.error}`)
      }
    } catch (error) {
      console.error('AIåˆ†æå¤±è´¥:', error)
      alert('AIåˆ†æå¤±è´¥')
    }
  }

  const handleFilterChange = (filterType: string, value: string) => {
    setFilters(prev => ({
      ...prev,
      [filterType]: value
    }))
  }

  const handleViewProductDetail = (productName: string) => {
    // æ¨¡æ‹Ÿè·å–å•†å“è¯¦ç»†æ•°æ®
    const mockProductDetail = {
      name: productName,
      category: 'ç”µå­äº§å“',
      performance: {
        totalSpend: 2345,
        totalGMV: 8765,
        totalViews: 456,
        ctr: 3.2,
        roi: 3.7,
        conversionRate: 2.1,
        avgOrderValue: 89.5
      },
      campaigns: [
        {
          id: '1',
          name: 'ç§‘æŠ€æ„Ÿäº§å“å±•ç¤º',
          platform: 'TikTok',
          status: 'active',
          spend: 1200,
          gmv: 4500,
          views: 230,
          ctr: 3.5,
          roi: 3.8,
          startDate: '2024-01-01',
          endDate: '2024-01-31'
        },
        {
          id: '2',
          name: 'åŠŸèƒ½æ¼”ç¤ºè§†é¢‘',
          platform: 'Instagram',
          status: 'paused',
          spend: 800,
          gmv: 3200,
          views: 180,
          ctr: 2.8,
          roi: 4.0,
          startDate: '2024-01-15',
          endDate: '2024-02-15'
        },
        {
          id: '3',
          name: 'ç”¨æˆ·è¯„ä»·åˆé›†',
          platform: 'YouTube',
          status: 'completed',
          spend: 345,
          gmv: 1065,
          views: 46,
          ctr: 3.1,
          roi: 3.1,
          startDate: '2024-01-20',
          endDate: '2024-01-25'
        }
      ],
      videos: [
        {
          id: '1',
          title: 'ç§‘æŠ€æ„Ÿäº§å“å±•ç¤º',
          platform: 'TikTok',
          duration: '30s',
          views: 230,
          likes: 45,
          shares: 12,
          comments: 8,
          ctr: 3.5,
          conversionRate: 2.1,
          createdAt: '2024-01-01'
        },
        {
          id: '2',
          title: 'åŠŸèƒ½æ¼”ç¤ºè§†é¢‘',
          platform: 'Instagram',
          duration: '60s',
          views: 180,
          likes: 38,
          shares: 9,
          comments: 5,
          ctr: 2.8,
          conversionRate: 1.8,
          createdAt: '2024-01-15'
        }
      ],
      trends: {
        dailySpend: [120, 135, 110, 145, 130, 140, 125],
        dailyGMV: [450, 520, 380, 580, 490, 560, 480],
        dailyViews: [25, 30, 22, 35, 28, 32, 26]
      }
    }
    
    setSelectedProduct(mockProductDetail)
    setShowProductDetail(true)
  }

  const handleSyncSheets = async () => {
    setIsSyncing(true)
    try {
      const response = await fetch('/api/admin/sync-sheets', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
      })
      
      const result = await response.json()
      if (result.success) {
        setSyncResult(result.data)
        // é‡æ–°åŠ è½½æ•°æ®
        // è¿™é‡Œå¯ä»¥æ·»åŠ é‡æ–°åŠ è½½é€»è¾‘
      }
    } catch (error) {
      console.error('åŒæ­¥å¤±è´¥:', error)
    } finally {
      setIsSyncing(false)
    }
  }

  const handleBulkUpload = async () => {
    if (!bulkUploadFile) return

    setBulkUploading(true)
    try {
      const formData = new FormData()
      formData.append('file', bulkUploadFile)
      formData.append('type', 'products') // æŒ‡å®šä¸Šä¼ ç±»å‹

      const response = await fetch('/api/admin/bulk-upload', {
        method: 'POST',
        body: formData
      })

      const result = await response.json()
      if (result.success) {
        alert(`æ‰¹é‡ä¸Šä¼ æˆåŠŸï¼å¤„ç†äº† ${result.processed} æ¡è®°å½•`)
        setShowBulkUpload(false)
        setBulkUploadFile(null)
        // é‡æ–°åŠ è½½æ•°æ®
        // TODO: å®ç°æ•°æ®é‡æ–°åŠ è½½é€»è¾‘
      } else {
        alert(`æ‰¹é‡ä¸Šä¼ å¤±è´¥ï¼š${result.error}`)
      }
    } catch (error) {
      console.error('æ‰¹é‡ä¸Šä¼ å¤±è´¥:', error)
      alert('æ‰¹é‡ä¸Šä¼ å¤±è´¥ï¼Œè¯·é‡è¯•')
    } finally {
      setBulkUploading(false)
    }
  }

  const handleAITuning = async () => {
    try {
      const response = await fetch('/api/ranking/ai-tuning', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({
          targetLevel: 'global',
          optimizationGoal: 'ctr'
        })
      })

      const result = await response.json()
      if (result.success) {
        alert('AIè°ƒå‚å®Œæˆï¼é¢„æœŸCTRæå‡' + result.data.expectedImprovement.ctrImprovement.toFixed(1) + '%')
        // è°ƒå‚å®Œæˆåå›åˆ°é£æ ¼åº“
        setShowRankingTuning(false)
        setActiveTab('styles')
      } else {
        alert(`AIè°ƒå‚å¤±è´¥ï¼š${result.error}`)
      }
    } catch (error) {
      console.error('AIè°ƒå‚å¤±è´¥:', error)
      alert('AIè°ƒå‚å¤±è´¥ï¼Œè¯·é‡è¯•')
    }
  }

  const handleSaveConfig = async () => {
    try {
      const response = await fetch('/api/ranking/tuning', {
        method: 'POST',
        headers: {
          'Content-Type': 'application/json',
        },
        body: JSON.stringify({
          level: 'global',
          levelId: 'global',
          coarseRanking: {
            weightFactors: {
              relevance: tuningConfig.coarseRanking.relevance / 100,
              quality: tuningConfig.coarseRanking.quality / 100,
              diversity: tuningConfig.coarseRanking.diversity / 100,
              recency: tuningConfig.coarseRanking.recency / 100
            }
          },
          fineRanking: {
            weightFactors: {
              userPreference: tuningConfig.fineRanking.userPreference / 100,
              businessValue: tuningConfig.fineRanking.businessValue / 100,
              technicalQuality: tuningConfig.fineRanking.technicalQuality / 100,
              marketTrend: tuningConfig.fineRanking.marketTrend / 100
            }
          }
        })
      })

      const result = await response.json()
      if (result.success) {
        alert('é…ç½®ä¿å­˜æˆåŠŸï¼')
      } else {
        alert(`ä¿å­˜å¤±è´¥ï¼š${result.error}`)
      }
    } catch (error) {
      console.error('ä¿å­˜é…ç½®å¤±è´¥:', error)
      alert('ä¿å­˜é…ç½®å¤±è´¥ï¼Œè¯·é‡è¯•')
    }
  }

  const renderProductForm = () => (
    <Card className="w-full max-w-2xl mx-auto">
      <CardHeader>
        <CardTitle>{editingProduct ? 'ç¼–è¾‘å•†å“' : 'æ·»åŠ å•†å“'}</CardTitle>
        <CardDescription>
          {editingProduct ? 'ä¿®æ”¹å•†å“ä¿¡æ¯' : 'æ·»åŠ æ–°å•†å“åˆ°å•†å“åº“'}
        </CardDescription>
      </CardHeader>
      <CardContent className="space-y-4">
        <div className="grid grid-cols-2 gap-4">
          <div>
            <Label htmlFor="name">å•†å“åç§°</Label>
            <Input id="name" defaultValue={editingProduct?.name || ''} />
          </div>
          <div>
            <Label htmlFor="category">ç±»ç›®</Label>
            <Select defaultValue={editingProduct?.category || ''}>
              <SelectTrigger>
                <SelectValue placeholder="é€‰æ‹©ç±»ç›®" />
              </SelectTrigger>
              <SelectContent>
                <SelectItem value="ç”µå­äº§å“">ç”µå­äº§å“</SelectItem>
                <SelectItem value="ç¾å¦†æŠ¤è‚¤">ç¾å¦†æŠ¤è‚¤</SelectItem>
                <SelectItem value="è¿åŠ¨å¥èº«">è¿åŠ¨å¥èº«</SelectItem>
                <SelectItem value="æœè£…é…é¥°">æœè£…é…é¥°</SelectItem>
              </SelectContent>
            </Select>
          </div>
        </div>

        <div>
          <Label htmlFor="description">å•†å“æè¿°</Label>
          <Textarea id="description" defaultValue={editingProduct?.description || ''} />
        </div>

        <div>
          <Label htmlFor="sellingPoints">å–ç‚¹ï¼ˆæ¯è¡Œä¸€ä¸ªï¼‰</Label>
          <Textarea 
            id="sellingPoints" 
            defaultValue={editingProduct?.sellingPoints?.join('\n') || ''} 
            rows={4}
          />
        </div>

        <div className="flex gap-2">
          <Button onClick={() => setShowProductForm(false)}>
            {editingProduct ? 'æ›´æ–°' : 'æ·»åŠ '}
          </Button>
          <Button variant="outline" onClick={() => setShowProductForm(false)}>
            å–æ¶ˆ
          </Button>
        </div>
      </CardContent>
    </Card>
  )

  const renderProductDetail = () => (
    <div className="space-y-6">
      {/* è¿”å›æŒ‰é’® */}
      <div className="flex items-center gap-4">
        <Button 
          variant="outline" 
          onClick={() => setShowProductDetail(false)}
          className="flex items-center gap-2"
        >
          â† è¿”å›æ•°æ®åˆ†æ
        </Button>
        <h2 className="text-2xl font-semibold">{selectedProduct?.name} - è¯¦ç»†åˆ†æ</h2>
      </div>

      {/* æ ¸å¿ƒæŒ‡æ ‡ */}
      <div className="grid grid-cols-1 md:grid-cols-4 gap-4">
        <Card>
          <CardContent className="p-6">
            <div className="text-center">
              <div className="text-3xl font-bold text-blue-600">${selectedProduct?.performance.totalSpend}</div>
              <div className="text-sm text-gray-600">æ€»èŠ±è´¹</div>
            </div>
          </CardContent>
        </Card>
        <Card>
          <CardContent className="p-6">
            <div className="text-center">
              <div className="text-3xl font-bold text-green-600">${selectedProduct?.performance.totalGMV}</div>
              <div className="text-sm text-gray-600">æ€»GMV</div>
            </div>
          </CardContent>
        </Card>
        <Card>
          <CardContent className="p-6">
            <div className="text-center">
              <div className="text-3xl font-bold text-purple-600">{selectedProduct?.performance.totalViews}</div>
              <div className="text-sm text-gray-600">æ€»æ’­æ”¾</div>
            </div>
          </CardContent>
        </Card>
        <Card>
          <CardContent className="p-6">
            <div className="text-center">
              <div className="text-3xl font-bold text-orange-600">{selectedProduct?.performance.roi}x</div>
              <div className="text-sm text-gray-600">ROI</div>
            </div>
          </CardContent>
        </Card>
      </div>

      {/* è¯¦ç»†æŒ‡æ ‡ */}
      <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
        <Card>
          <CardHeader>
            <CardTitle>è½¬åŒ–æŒ‡æ ‡</CardTitle>
          </CardHeader>
          <CardContent className="space-y-2">
            <div className="flex justify-between">
              <span className="text-sm text-gray-600">CTR</span>
              <span className="font-medium">{selectedProduct?.performance.ctr}%</span>
            </div>
            <div className="flex justify-between">
              <span className="text-sm text-gray-600">è½¬åŒ–ç‡</span>
              <span className="font-medium">{selectedProduct?.performance.conversionRate}%</span>
            </div>
            <div className="flex justify-between">
              <span className="text-sm text-gray-600">å®¢å•ä»·</span>
              <span className="font-medium">${selectedProduct?.performance.avgOrderValue}</span>
            </div>
          </CardContent>
        </Card>

        <Card>
          <CardHeader>
            <CardTitle>è¶‹åŠ¿åˆ†æ</CardTitle>
          </CardHeader>
          <CardContent>
            <div className="space-y-2">
              <div className="text-sm text-gray-600">æœ€è¿‘7å¤©è¶‹åŠ¿</div>
              <div className="text-xs text-gray-500">
                èŠ±è´¹: ${selectedProduct?.trends.dailySpend.join(', ')}
              </div>
              <div className="text-xs text-gray-500">
                GMV: ${selectedProduct?.trends.dailyGMV.join(', ')}
              </div>
              <div className="text-xs text-gray-500">
                æ’­æ”¾: {selectedProduct?.trends.dailyViews.join(', ')}
              </div>
            </div>
          </CardContent>
        </Card>

        <Card>
          <CardHeader>
            <CardTitle>å¹³å°åˆ†å¸ƒ</CardTitle>
          </CardHeader>
          <CardContent>
            <div className="space-y-2">
              <div className="flex justify-between text-sm">
                <span>TikTok</span>
                <span className="font-medium">45%</span>
              </div>
              <div className="flex justify-between text-sm">
                <span>Instagram</span>
                <span className="font-medium">35%</span>
              </div>
              <div className="flex justify-between text-sm">
                <span>YouTube</span>
                <span className="font-medium">20%</span>
              </div>
            </div>
          </CardContent>
        </Card>
      </div>

      {/* å¹¿å‘Šç³»åˆ—è¯¦æƒ… */}
      <Card>
        <CardHeader>
          <CardTitle>å¹¿å‘Šç³»åˆ—è¡¨ç°</CardTitle>
          <CardDescription>å„å¹¿å‘Šç³»åˆ—çš„è¯¦ç»†æ•°æ®</CardDescription>
        </CardHeader>
        <CardContent>
          <div className="border rounded-lg">
            <table className="w-full">
              <thead className="bg-gray-50">
                <tr>
                  <th className="px-4 py-3 text-left text-sm font-medium text-gray-900">å¹¿å‘Šç³»åˆ—</th>
                  <th className="px-4 py-3 text-left text-sm font-medium text-gray-900">å¹³å°</th>
                  <th className="px-4 py-3 text-left text-sm font-medium text-gray-900">çŠ¶æ€</th>
                  <th className="px-4 py-3 text-left text-sm font-medium text-gray-900">èŠ±è´¹</th>
                  <th className="px-4 py-3 text-left text-sm font-medium text-gray-900">GMV</th>
                  <th className="px-4 py-3 text-left text-sm font-medium text-gray-900">æ’­æ”¾</th>
                  <th className="px-4 py-3 text-left text-sm font-medium text-gray-900">CTR</th>
                  <th className="px-4 py-3 text-left text-sm font-medium text-gray-900">ROI</th>
                </tr>
              </thead>
              <tbody className="divide-y divide-gray-200">
                {selectedProduct?.campaigns.map((campaign: any) => (
                  <tr key={campaign.id} className="hover:bg-gray-50">
                    <td className="px-4 py-3">
                      <div className="font-medium text-gray-900">{campaign.name}</div>
                      <div className="text-sm text-gray-500">
                        {campaign.startDate} - {campaign.endDate}
                      </div>
                    </td>
                    <td className="px-4 py-3">
                      <Badge variant="outline">{campaign.platform}</Badge>
                    </td>
                    <td className="px-4 py-3">
                      <Badge 
                        variant={campaign.status === 'active' ? 'default' : 
                                campaign.status === 'paused' ? 'secondary' : 'outline'}
                      >
                        {campaign.status === 'active' ? 'è¿›è¡Œä¸­' : 
                         campaign.status === 'paused' ? 'æš‚åœ' : 'å·²å®Œæˆ'}
                      </Badge>
                    </td>
                    <td className="px-4 py-3 text-sm text-gray-900">${campaign.spend}</td>
                    <td className="px-4 py-3 text-sm text-gray-900">${campaign.gmv}</td>
                    <td className="px-4 py-3 text-sm text-gray-900">{campaign.views}</td>
                    <td className="px-4 py-3 text-sm text-gray-900">{campaign.ctr}%</td>
                    <td className="px-4 py-3 text-sm text-gray-900">{campaign.roi}x</td>
                  </tr>
                ))}
              </tbody>
            </table>
          </div>
        </CardContent>
      </Card>

      {/* è§†é¢‘è¡¨ç° */}
      <Card>
        <CardHeader>
          <CardTitle>è§†é¢‘è¡¨ç°è¯¦æƒ…</CardTitle>
          <CardDescription>å„è§†é¢‘çš„è¯¦ç»†è¡¨ç°æ•°æ®</CardDescription>
        </CardHeader>
        <CardContent>
          <div className="border rounded-lg">
            <table className="w-full">
              <thead className="bg-gray-50">
                <tr>
                  <th className="px-4 py-3 text-left text-sm font-medium text-gray-900">è§†é¢‘æ ‡é¢˜</th>
                  <th className="px-4 py-3 text-left text-sm font-medium text-gray-900">å¹³å°</th>
                  <th className="px-4 py-3 text-left text-sm font-medium text-gray-900">æ—¶é•¿</th>
                  <th className="px-4 py-3 text-left text-sm font-medium text-gray-900">æ’­æ”¾</th>
                  <th className="px-4 py-3 text-left text-sm font-medium text-gray-900">ç‚¹èµ</th>
                  <th className="px-4 py-3 text-left text-sm font-medium text-gray-900">åˆ†äº«</th>
                  <th className="px-4 py-3 text-left text-sm font-medium text-gray-900">è¯„è®º</th>
                  <th className="px-4 py-3 text-left text-sm font-medium text-gray-900">CTR</th>
                  <th className="px-4 py-3 text-left text-sm font-medium text-gray-900">è½¬åŒ–ç‡</th>
                </tr>
              </thead>
              <tbody className="divide-y divide-gray-200">
                {selectedProduct?.videos.map((video: any) => (
                  <tr key={video.id} className="hover:bg-gray-50">
                    <td className="px-4 py-3">
                      <div className="font-medium text-gray-900">{video.title}</div>
                      <div className="text-sm text-gray-500">{video.createdAt}</div>
                    </td>
                    <td className="px-4 py-3">
                      <Badge variant="outline">{video.platform}</Badge>
                    </td>
                    <td className="px-4 py-3 text-sm text-gray-900">{video.duration}</td>
                    <td className="px-4 py-3 text-sm text-gray-900">{video.views}</td>
                    <td className="px-4 py-3 text-sm text-gray-900">{video.likes}</td>
                    <td className="px-4 py-3 text-sm text-gray-900">{video.shares}</td>
                    <td className="px-4 py-3 text-sm text-gray-900">{video.comments}</td>
                    <td className="px-4 py-3 text-sm text-gray-900">{video.ctr}%</td>
                    <td className="px-4 py-3 text-sm text-gray-900">{video.conversionRate}%</td>
                  </tr>
                ))}
              </tbody>
            </table>
          </div>
        </CardContent>
      </Card>
    </div>
  )

  const renderRankingTuning = () => (
    <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
      <Card className="w-full max-w-6xl mx-4 max-h-[90vh] overflow-y-auto">
        <CardHeader>
          <div className="flex justify-between items-center">
            <div>
              <CardTitle>è°ƒå‚ä¼˜åŒ–</CardTitle>
              <CardDescription>ä¼˜åŒ–æ¨¡ç‰ˆçš„ç²—æ’å’Œç²¾æ’ç®—æ³•å‚æ•°ï¼Œè®©é¢„ä¼°å€¼å’Œå®é™…è¡¨ç°æ•°æ®è¶Šæ¥è¶Šå‡†</CardDescription>
            </div>
            <Button variant="outline" onClick={() => setShowRankingTuning(false)}>
              âœ• å…³é—­
            </Button>
          </div>
        </CardHeader>
        <CardContent className="space-y-6">
          {/* å½“å‰é…ç½®æ¦‚è§ˆ */}
          <div className="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4">
            <Card>
              <CardContent className="p-4">
                <div className="text-center">
                  <div className="text-xl font-bold text-blue-600">ç²—æ’-ç±»ç›®-30%</div>
                  <div className="text-sm text-gray-600">ç›¸å…³æ€§æƒé‡</div>
                  <div className="text-xs text-red-600 mt-1">âš ï¸ æƒé‡è¿‡é«˜</div>
                </div>
              </CardContent>
            </Card>
            <Card>
              <CardContent className="p-4">
                <div className="text-center">
                  <div className="text-xl font-bold text-green-600">ç²¾æ’-è´¨é‡-25%</div>
                  <div className="text-sm text-gray-600">è´¨é‡æƒé‡</div>
                  <div className="text-xs text-green-600 mt-1">âœ“ è¡¨ç°è‰¯å¥½</div>
                </div>
              </CardContent>
            </Card>
            <Card>
              <CardContent className="p-4">
                <div className="text-center">
                  <div className="text-xl font-bold text-purple-600">CTR: 2.1%</div>
                  <div className="text-sm text-gray-600">å½“å‰ç‚¹å‡»ç‡</div>
                  <div className="text-xs text-red-600 mt-1">â†“ ä½äºé¢„æœŸ</div>
                </div>
              </CardContent>
            </Card>
            <Card>
              <CardContent className="p-4">
                <div className="text-center">
                  <div className="text-xl font-bold text-orange-600">CVR: 1.8%</div>
                  <div className="text-sm text-gray-600">å½“å‰è½¬åŒ–ç‡</div>
                  <div className="text-xs text-red-600 mt-1">â†“ ä½äºé¢„æœŸ</div>
                </div>
              </CardContent>
            </Card>
          </div>

          {/* AIä¸€é”®è°ƒå‚æŒ‰é’® */}
          <div className="flex justify-center gap-4">
            <Button onClick={handleAITuning} className="bg-blue-600 hover:bg-blue-700">
              <Brain className="h-4 w-4 mr-2" />
              AIä¸€é”®è°ƒå‚
            </Button>
          </div>

          {/* å‚æ•°é…ç½® */}
          <Card>
            <CardHeader>
              <CardTitle>ç²—æ’å’Œç²¾æ’å‚æ•°é…ç½®</CardTitle>
              <CardDescription>å±•ç¤ºå½“å‰å„å±‚çº§å‚æ•°é…ç½®ï¼Œæ”¯æŒæ‰‹å·¥è°ƒæ•´å¤§ç›˜å‚æ•°</CardDescription>
            </CardHeader>
            <CardContent>
              <div className="space-y-6">
                {/* å¤§ç›˜é…ç½® */}
                <div>
                  <h3 className="text-lg font-semibold mb-4">å¤§ç›˜é…ç½®ï¼ˆç”¨æˆ·å¯è°ƒï¼‰</h3>
                  <div className="grid grid-cols-1 md:grid-cols-2 gap-4">
                    <Card>
                      <CardHeader>
                        <CardTitle className="text-base">ç²—æ’å‚æ•°</CardTitle>
                      </CardHeader>
                      <CardContent className="space-y-4">
                        <div className="space-y-3">
                          <div className="space-y-2">
                            <div className="flex justify-between items-center">
                              <span className="text-sm">ç›¸å…³æ€§æƒé‡</span>
                              <span className="text-sm font-medium">{tuningConfig.coarseRanking.relevance}%</span>
                            </div>
                            <input
                              type="range"
                              min="0"
                              max="100"
                              value={tuningConfig.coarseRanking.relevance}
                              onChange={(e) => setTuningConfig(prev => ({
                                ...prev,
                                coarseRanking: { ...prev.coarseRanking, relevance: parseInt(e.target.value) }
                              }))}
                              className="w-full"
                            />
                          </div>
                          <div className="space-y-2">
                            <div className="flex justify-between items-center">
                              <span className="text-sm">è´¨é‡æƒé‡</span>
                              <span className="text-sm font-medium">{tuningConfig.coarseRanking.quality}%</span>
                            </div>
                            <input
                              type="range"
                              min="0"
                              max="100"
                              value={tuningConfig.coarseRanking.quality}
                              onChange={(e) => setTuningConfig(prev => ({
                                ...prev,
                                coarseRanking: { ...prev.coarseRanking, quality: parseInt(e.target.value) }
                              }))}
                              className="w-full"
                            />
                          </div>
                          <div className="space-y-2">
                            <div className="flex justify-between items-center">
                              <span className="text-sm">å¤šæ ·æ€§æƒé‡</span>
                              <span className="text-sm font-medium">{tuningConfig.coarseRanking.diversity}%</span>
                            </div>
                            <input
                              type="range"
                              min="0"
                              max="100"
                              value={tuningConfig.coarseRanking.diversity}
                              onChange={(e) => setTuningConfig(prev => ({
                                ...prev,
                                coarseRanking: { ...prev.coarseRanking, diversity: parseInt(e.target.value) }
                              }))}
                              className="w-full"
                            />
                          </div>
                          <div className="space-y-2">
                            <div className="flex justify-between items-center">
                              <span className="text-sm">æ—¶æ•ˆæ€§æƒé‡</span>
                              <span className="text-sm font-medium">{tuningConfig.coarseRanking.recency}%</span>
                            </div>
                            <input
                              type="range"
                              min="0"
                              max="100"
                              value={tuningConfig.coarseRanking.recency}
                              onChange={(e) => setTuningConfig(prev => ({
                                ...prev,
                                coarseRanking: { ...prev.coarseRanking, recency: parseInt(e.target.value) }
                              }))}
                              className="w-full"
                            />
                          </div>
                        </div>
                      </CardContent>
                    </Card>
                    
                    <Card>
                      <CardHeader>
                        <CardTitle className="text-base">ç²¾æ’å‚æ•°</CardTitle>
                      </CardHeader>
                      <CardContent className="space-y-4">
                        <div className="space-y-3">
                          <div className="space-y-2">
                            <div className="flex justify-between items-center">
                              <span className="text-sm">ç”¨æˆ·åå¥½æƒé‡</span>
                              <span className="text-sm font-medium">{tuningConfig.fineRanking.userPreference}%</span>
                            </div>
                            <input
                              type="range"
                              min="0"
                              max="100"
                              value={tuningConfig.fineRanking.userPreference}
                              onChange={(e) => setTuningConfig(prev => ({
                                ...prev,
                                fineRanking: { ...prev.fineRanking, userPreference: parseInt(e.target.value) }
                              }))}
                              className="w-full"
                            />
                          </div>
                          <div className="space-y-2">
                            <div className="flex justify-between items-center">
                              <span className="text-sm">å•†ä¸šä»·å€¼æƒé‡</span>
                              <span className="text-sm font-medium">{tuningConfig.fineRanking.businessValue}%</span>
                            </div>
                            <input
                              type="range"
                              min="0"
                              max="100"
                              value={tuningConfig.fineRanking.businessValue}
                              onChange={(e) => setTuningConfig(prev => ({
                                ...prev,
                                fineRanking: { ...prev.fineRanking, businessValue: parseInt(e.target.value) }
                              }))}
                              className="w-full"
                            />
                          </div>
                          <div className="space-y-2">
                            <div className="flex justify-between items-center">
                              <span className="text-sm">æŠ€æœ¯è´¨é‡æƒé‡</span>
                              <span className="text-sm font-medium">{tuningConfig.fineRanking.technicalQuality}%</span>
                            </div>
                            <input
                              type="range"
                              min="0"
                              max="100"
                              value={tuningConfig.fineRanking.technicalQuality}
                              onChange={(e) => setTuningConfig(prev => ({
                                ...prev,
                                fineRanking: { ...prev.fineRanking, technicalQuality: parseInt(e.target.value) }
                              }))}
                              className="w-full"
                            />
                          </div>
                          <div className="space-y-2">
                            <div className="flex justify-between items-center">
                              <span className="text-sm">å¸‚åœºè¶‹åŠ¿æƒé‡</span>
                              <span className="text-sm font-medium">{tuningConfig.fineRanking.marketTrend}%</span>
                            </div>
                            <input
                              type="range"
                              min="0"
                              max="100"
                              value={tuningConfig.fineRanking.marketTrend}
                              onChange={(e) => setTuningConfig(prev => ({
                                ...prev,
                                fineRanking: { ...prev.fineRanking, marketTrend: parseInt(e.target.value) }
                              }))}
                              className="w-full"
                            />
                          </div>
                        </div>
                      </CardContent>
                    </Card>
                  </div>
                  
                  {/* ä¿å­˜æŒ‰é’® */}
                  <div className="flex justify-center mt-6">
                    <Button onClick={handleSaveConfig} className="bg-green-600 hover:bg-green-700">
                      ä¿å­˜é…ç½®
                    </Button>
                  </div>
                </div>

                {/* æ•°æ®åˆ†æå»ºè®® */}
                <Card>
                  <CardHeader>
                    <CardTitle>æ•°æ®åˆ†æä¸ä¼˜åŒ–å»ºè®®</CardTitle>
                  </CardHeader>
                  <CardContent>
                    <div className="space-y-4">
                      <div className="bg-yellow-50 border border-yellow-200 rounded-lg p-4">
                        <div className="flex items-start">
                          <div className="flex-shrink-0">
                            <div className="text-yellow-600 text-xl">âš ï¸</div>
                          </div>
                          <div className="ml-3">
                            <h4 className="text-sm font-medium text-yellow-800">å‚æ•°é…ç½®é—®é¢˜</h4>
                            <div className="mt-2 text-sm text-yellow-700">
                              <ul className="list-disc list-inside space-y-1">
                                <li>ç›¸å…³æ€§æƒé‡30%è¿‡é«˜ï¼Œå¯¼è‡´å¾ˆå¤šè¡¨ç°å·®çš„æ¨¡ç‰ˆèƒœå‡º</li>
                                <li>ç”µå­äº§å“ç±»ç›®ä¸‹ï¼Œè´¨é‡æƒé‡åº”è¯¥æ›´é«˜</li>
                                <li>å¤šæ ·æ€§æƒé‡25%å¯èƒ½å½±å“è½¬åŒ–æ•ˆæœ</li>
                              </ul>
                            </div>
                          </div>
                        </div>
                      </div>
                      
                      <div className="bg-blue-50 border border-blue-200 rounded-lg p-4">
                        <div className="flex items-start">
                          <div className="flex-shrink-0">
                            <div className="text-blue-600 text-xl">ğŸ’¡</div>
                          </div>
                          <div className="ml-3">
                            <h4 className="text-sm font-medium text-blue-800">AIä¼˜åŒ–å»ºè®®</h4>
                            <div className="mt-2 text-sm text-blue-700">
                              <ul className="list-disc list-inside space-y-1">
                                <li>å»ºè®®å°†ç›¸å…³æ€§æƒé‡é™ä½è‡³25%ï¼Œè´¨é‡æƒé‡æé«˜è‡³30%</li>
                                <li>é’ˆå¯¹ç”µå­äº§å“ç±»ç›®ï¼Œå»ºè®®è´¨é‡æƒé‡æå‡è‡³35%</li>
                                <li>è€ƒè™‘å¼•å…¥æ—¶é—´è¡°å‡å› å­ï¼Œé™ä½æ—§æ¨¡ç‰ˆçš„å½±å“</li>
                                <li>å»ºè®®å¯ç”¨A/Bæµ‹è¯•éªŒè¯å‚æ•°è°ƒæ•´æ•ˆæœ</li>
                              </ul>
                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </CardContent>
                </Card>
              </div>
            </CardContent>
          </Card>
        </CardContent>
      </Card>
    </div>
  )

  const renderStyleForm = () => (
    <Card className="w-full max-w-2xl mx-auto">
      <CardHeader>
        <CardTitle>{editingStyle ? 'ç¼–è¾‘é£æ ¼' : 'æ·»åŠ é£æ ¼'}</CardTitle>
        <CardDescription>
          {editingStyle ? 'ä¿®æ”¹é£æ ¼ä¿¡æ¯' : 'æ·»åŠ æ–°é£æ ¼åˆ°é£æ ¼åº“'}
        </CardDescription>
      </CardHeader>
      <CardContent className="space-y-4">
        <div className="grid grid-cols-2 gap-4">
          <div>
            <Label htmlFor="styleName">é£æ ¼åç§°</Label>
            <Input id="styleName" defaultValue={editingStyle?.name || ''} />
          </div>
          <div>
            <Label htmlFor="styleCategory">ç±»ç›®</Label>
            <Select defaultValue={editingStyle?.category || ''}>
              <SelectTrigger>
                <SelectValue placeholder="é€‰æ‹©ç±»ç›®" />
              </SelectTrigger>
              <SelectContent>
                <SelectItem value="ç”µå­äº§å“">ç”µå­äº§å“</SelectItem>
                <SelectItem value="ç¾å¦†æŠ¤è‚¤">ç¾å¦†æŠ¤è‚¤</SelectItem>
                <SelectItem value="è¿åŠ¨å¥èº«">è¿åŠ¨å¥èº«</SelectItem>
                <SelectItem value="æœè£…é…é¥°">æœè£…é…é¥°</SelectItem>
              </SelectContent>
            </Select>
          </div>
        </div>

        <div>
          <Label htmlFor="styleDescription">é£æ ¼æè¿°</Label>
          <Textarea id="styleDescription" defaultValue={editingStyle?.description || ''} />
        </div>

        <div className="grid grid-cols-2 gap-4">
          <div>
            <Label htmlFor="tone">è¯­è°ƒ</Label>
            <Select defaultValue={editingStyle?.tone || ''}>
              <SelectTrigger>
                <SelectValue placeholder="é€‰æ‹©è¯­è°ƒ" />
              </SelectTrigger>
              <SelectContent>
                <SelectItem value="professional">ä¸“ä¸š</SelectItem>
                <SelectItem value="elegant">ä¼˜é›…</SelectItem>
                <SelectItem value="energetic">æ´»åŠ›</SelectItem>
                <SelectItem value="casual">ä¼‘é—²</SelectItem>
              </SelectContent>
            </Select>
          </div>
          <div>
            <Label htmlFor="isActive">çŠ¶æ€</Label>
            <Select defaultValue={editingStyle?.isActive ? 'true' : 'false'}>
              <SelectTrigger>
                <SelectValue placeholder="é€‰æ‹©çŠ¶æ€" />
              </SelectTrigger>
              <SelectContent>
                <SelectItem value="true">å¯ç”¨</SelectItem>
                <SelectItem value="false">ç¦ç”¨</SelectItem>
              </SelectContent>
            </Select>
          </div>
        </div>

        <div className="flex gap-2">
          <Button onClick={() => setShowStyleForm(false)}>
            {editingStyle ? 'æ›´æ–°' : 'æ·»åŠ '}
          </Button>
          <Button variant="outline" onClick={() => setShowStyleForm(false)}>
            å–æ¶ˆ
          </Button>
        </div>
      </CardContent>
    </Card>
  )

  const renderUserForm = () => (
    <Card className="w-full max-w-2xl mx-auto">
      <CardHeader>
        <CardTitle>{editingUser ? 'ç¼–è¾‘ç”¨æˆ·' : 'æ·»åŠ ç”¨æˆ·'}</CardTitle>
        <CardDescription>
          {editingUser ? 'ä¿®æ”¹ç”¨æˆ·ä¿¡æ¯' : 'æ·»åŠ æ–°ç”¨æˆ·åˆ°ç³»ç»Ÿ'}
        </CardDescription>
      </CardHeader>
      <CardContent className="space-y-4">
        <div className="grid grid-cols-2 gap-4">
          <div>
            <Label htmlFor="userName">å§“å</Label>
            <Input id="userName" defaultValue={editingUser?.name || ''} />
          </div>
          <div>
            <Label htmlFor="userEmail">é‚®ç®±</Label>
            <Input id="userEmail" type="email" defaultValue={editingUser?.email || ''} />
          </div>
        </div>

        <div className="grid grid-cols-2 gap-4">
          <div>
            <Label htmlFor="userRole">è§’è‰²</Label>
            <Select defaultValue={editingUser?.role || 'viewer'}>
              <SelectTrigger>
                <SelectValue placeholder="é€‰æ‹©è§’è‰²" />
              </SelectTrigger>
              <SelectContent>
                <SelectItem value="admin">ç®¡ç†å‘˜</SelectItem>
                <SelectItem value="manager">ç»ç†</SelectItem>
                <SelectItem value="operator">æ“ä½œå‘˜</SelectItem>
                <SelectItem value="viewer">æŸ¥çœ‹è€…</SelectItem>
              </SelectContent>
            </Select>
          </div>
          <div>
            <Label htmlFor="userPassword">å¯†ç </Label>
            <Input id="userPassword" type="password" placeholder="ç•™ç©ºåˆ™ä¸ä¿®æ”¹" />
          </div>
        </div>

        <div className="flex gap-2">
          <Button onClick={() => {
            const formData = {
              name: (document.getElementById('userName') as HTMLInputElement)?.value,
              email: (document.getElementById('userEmail') as HTMLInputElement)?.value,
              role: (document.getElementById('userRole') as HTMLSelectElement)?.value,
              password: (document.getElementById('userPassword') as HTMLInputElement)?.value
            }
            handleCreateUser(formData)
          }}>
            {editingUser ? 'æ›´æ–°' : 'æ·»åŠ '}
          </Button>
          <Button variant="outline" onClick={() => setShowUserForm(false)}>
            å–æ¶ˆ
          </Button>
        </div>
      </CardContent>
    </Card>
  )

  const renderPainPointForm = () => (
    <Card className="w-full max-w-2xl mx-auto">
      <CardHeader>
        <CardTitle>æ‰‹åŠ¨æ·»åŠ ç—›ç‚¹åˆ†æ</CardTitle>
        <CardDescription>
          æ‰‹åŠ¨æ·»åŠ äº§å“ç—›ç‚¹åˆ†ææ•°æ®
        </CardDescription>
      </CardHeader>
      <CardContent className="space-y-4">
        <div className="grid grid-cols-2 gap-4">
          <div>
            <Label htmlFor="painProduct">äº§å“</Label>
            <Select>
              <SelectTrigger>
                <SelectValue placeholder="é€‰æ‹©äº§å“" />
              </SelectTrigger>
              <SelectContent>
                {products.map(product => (
                  <SelectItem key={product.id} value={product.id}>
                    {product.name}
                  </SelectItem>
                ))}
              </SelectContent>
            </Select>
          </div>
          <div>
            <Label htmlFor="painPlatform">å¹³å°</Label>
            <Select>
              <SelectTrigger>
                <SelectValue placeholder="é€‰æ‹©å¹³å°" />
              </SelectTrigger>
              <SelectContent>
                <SelectItem value="shopee">Shopee</SelectItem>
                <SelectItem value="tiktok">TikTok</SelectItem>
                <SelectItem value="amazon">Amazon</SelectItem>
                <SelectItem value="facebook">Facebook</SelectItem>
              </SelectContent>
            </Select>
          </div>
        </div>

        <div>
          <Label htmlFor="painPoints">ç—›ç‚¹ï¼ˆæ¯è¡Œä¸€ä¸ªï¼‰</Label>
          <Textarea 
            id="painPoints" 
            rows={4}
            placeholder="éŸ³è´¨ä¸å¤Ÿæ¸…æ™°&#10;ç”µæ± ç»­èˆªçŸ­&#10;è¿æ¥ä¸ç¨³å®š"
          />
        </div>

        <div className="grid grid-cols-2 gap-4">
          <div>
            <Label htmlFor="painSeverity">ä¸¥é‡ç¨‹åº¦</Label>
            <Select>
              <SelectTrigger>
                <SelectValue placeholder="é€‰æ‹©ä¸¥é‡ç¨‹åº¦" />
              </SelectTrigger>
              <SelectContent>
                <SelectItem value="low">ä½</SelectItem>
                <SelectItem value="medium">ä¸­</SelectItem>
                <SelectItem value="high">é«˜</SelectItem>
              </SelectContent>
            </Select>
          </div>
          <div>
            <Label htmlFor="painSentiment">æƒ…æ„Ÿ</Label>
            <Select>
              <SelectTrigger>
                <SelectValue placeholder="é€‰æ‹©æƒ…æ„Ÿ" />
              </SelectTrigger>
              <SelectContent>
                <SelectItem value="positive">æ­£é¢</SelectItem>
                <SelectItem value="neutral">ä¸­æ€§</SelectItem>
                <SelectItem value="negative">è´Ÿé¢</SelectItem>
              </SelectContent>
            </Select>
          </div>
        </div>

        <div className="flex gap-2">
          <Button onClick={() => setShowPainPointForm(false)}>
            æ·»åŠ 
          </Button>
          <Button variant="outline" onClick={() => setShowPainPointForm(false)}>
            å–æ¶ˆ
          </Button>
        </div>
      </CardContent>
    </Card>
  )

  const renderScrapingModal = () => (
    <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
      <Card className="w-full max-w-md mx-4">
        <CardHeader>
          <CardTitle>å¼€å§‹è¯„è®ºçˆ¬å–</CardTitle>
          <CardDescription>
            é…ç½®çˆ¬å–å‚æ•°ï¼Œä»æŒ‡å®šå¹³å°è·å–äº§å“è¯„è®º
          </CardDescription>
        </CardHeader>
        <CardContent className="space-y-4">
          <div>
            <Label htmlFor="scrapingProduct">é€‰æ‹©äº§å“</Label>
            <Select onValueChange={(value) => setScrapingConfig(prev => ({ ...prev, productId: value }))}>
              <SelectTrigger>
                <SelectValue placeholder="é€‰æ‹©äº§å“" />
              </SelectTrigger>
              <SelectContent>
                {products.map(product => (
                  <SelectItem key={product.id} value={product.id}>
                    {product.name}
                  </SelectItem>
                ))}
              </SelectContent>
            </Select>
          </div>

          <div>
            <Label htmlFor="scrapingPlatform">ç›®æ ‡å¹³å°</Label>
            <Select onValueChange={(value) => setScrapingConfig(prev => ({ ...prev, platform: value }))}>
              <SelectTrigger>
                <SelectValue placeholder="é€‰æ‹©å¹³å°" />
              </SelectTrigger>
              <SelectContent>
                <SelectItem value="shopee">Shopee</SelectItem>
                <SelectItem value="tiktok">TikTok</SelectItem>
                <SelectItem value="amazon">Amazon</SelectItem>
                <SelectItem value="facebook">Facebook</SelectItem>
              </SelectContent>
            </Select>
          </div>

          <div>
            <Label htmlFor="scrapingKeywords">æœç´¢å…³é”®è¯</Label>
            <Input 
              id="scrapingKeywords"
              placeholder="äº§å“ç›¸å…³å…³é”®è¯"
              value={scrapingConfig.keywords}
              onChange={(e) => setScrapingConfig(prev => ({ ...prev, keywords: e.target.value }))}
            />
          </div>

          <div>
            <Label htmlFor="scrapingMaxComments">æœ€å¤§è¯„è®ºæ•°</Label>
            <Input 
              id="scrapingMaxComments"
              type="number"
              placeholder="100"
              value={scrapingConfig.maxComments}
              onChange={(e) => setScrapingConfig(prev => ({ ...prev, maxComments: parseInt(e.target.value) }))}
            />
          </div>

          <div className="flex justify-end space-x-2">
            <Button 
              variant="outline" 
              onClick={() => setShowScrapingModal(false)}
            >
              å–æ¶ˆ
            </Button>
            <Button 
              onClick={() => {
                const productId = (document.querySelector('[data-value]') as HTMLElement)?.getAttribute('data-value')
                if (productId) {
                  handleStartScraping(productId)
                }
              }}
            >
              å¼€å§‹çˆ¬å–
            </Button>
          </div>
        </CardContent>
      </Card>
    </div>
  )

  const renderSubmissionDetail = () => {
    if (!selectedSubmission) return null

    const submissionData = JSON.parse(selectedSubmission.data)
    const originalData = selectedSubmission.originalData ? JSON.parse(selectedSubmission.originalData) : null

    return (
      <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
        <Card className="w-full max-w-4xl mx-4 max-h-[90vh] overflow-y-auto">
          <CardHeader>
            <CardTitle>ç”¨æˆ·æäº¤è¯¦æƒ…</CardTitle>
            <CardDescription>
              {selectedSubmission.type === 'style' ? 'é£æ ¼ä¿¡æ¯' : 'å•†å“ä¿¡æ¯'} - 
              {selectedSubmission.source === 'user_video_analysis' ? 'ç”¨æˆ·è§†é¢‘è§£æ' :
               selectedSubmission.source === 'user_modified' ? 'ç”¨æˆ·ä¿®æ”¹' :
               selectedSubmission.source === 'user_analysis' ? 'ç”¨æˆ·åˆ†æ' : 'æ‰‹åŠ¨ä¸Šä¼ '}
            </CardDescription>
          </CardHeader>
          <CardContent className="space-y-6">
            {/* åŸºæœ¬ä¿¡æ¯ */}
            <div className="grid grid-cols-2 gap-4">
              <div>
                <Label>æäº¤ç±»å‹</Label>
                <div className="text-sm text-gray-600">
                  {selectedSubmission.type === 'style' ? 'é£æ ¼' : 'å•†å“'}
                </div>
              </div>
              <div>
                <Label>çŠ¶æ€</Label>
                <div className="text-sm">
                  <Badge variant={
                    selectedSubmission.status === 'pending' ? 'secondary' :
                    selectedSubmission.status === 'approved' ? 'default' : 'destructive'
                  }>
                    {selectedSubmission.status === 'pending' ? 'å¾…å®¡æ ¸' :
                     selectedSubmission.status === 'approved' ? 'å·²é€šè¿‡' : 'å·²æ‹’ç»'}
                  </Badge>
                </div>
              </div>
              <div>
                <Label>æäº¤æ—¶é—´</Label>
                <div className="text-sm text-gray-600">
                  {new Date(selectedSubmission.createdAt).toLocaleString()}
                </div>
              </div>
              <div>
                <Label>æ¥æº</Label>
                <div className="text-sm text-gray-600">
                  {selectedSubmission.sourceUrl && (
                    <a href={selectedSubmission.sourceUrl} target="_blank" rel="noopener noreferrer" className="text-blue-600 hover:underline">
                      {selectedSubmission.sourceUrl}
                    </a>
                  )}
                </div>
              </div>
            </div>

            {/* æäº¤çš„æ•°æ® */}
            <div>
              <Label>æäº¤çš„æ•°æ®</Label>
              <div className="mt-2 p-4 bg-gray-50 rounded-lg">
                <pre className="text-sm whitespace-pre-wrap">
                  {JSON.stringify(submissionData, null, 2)}
                </pre>
              </div>
            </div>

            {/* åŸå§‹æ•°æ®å¯¹æ¯”ï¼ˆå¦‚æœæœ‰ï¼‰ */}
            {originalData && (
              <div>
                <Label>åŸå§‹æ•°æ®å¯¹æ¯”</Label>
                <div className="mt-2 p-4 bg-gray-50 rounded-lg">
                  <pre className="text-sm whitespace-pre-wrap">
                    {JSON.stringify(originalData, null, 2)}
                  </pre>
                </div>
              </div>
            )}

            {/* å®¡æ ¸æ“ä½œ */}
            {selectedSubmission.status === 'pending' && (
              <div className="flex gap-4">
                <Button 
                  onClick={() => handleReviewSubmission(selectedSubmission.id, 'approved')}
                  className="flex-1"
                >
                  é€šè¿‡
                </Button>
                <Button 
                  variant="destructive"
                  onClick={() => handleReviewSubmission(selectedSubmission.id, 'rejected')}
                  className="flex-1"
                >
                  æ‹’ç»
                </Button>
              </div>
            )}

            {/* å…³é—­æŒ‰é’® */}
            <div className="flex justify-end">
              <Button variant="outline" onClick={() => {
                setShowSubmissionDetail(false)
                setSelectedSubmission(null)
              }}>
                å…³é—­
              </Button>
            </div>
          </CardContent>
        </Card>
      </div>
    )
  }

  return (
    <div className="min-h-screen py-8">
      <div className="container mx-auto px-4">
        <div className="text-center mb-8">
          <h1 className="text-4xl font-bold text-gray-900 mb-4">
            ç®¡ç†å‘˜æ§åˆ¶å°
          </h1>
          <p className="text-xl text-gray-600">
            ç®¡ç†å•†å“åº“ã€é£æ ¼åº“å’Œç³»ç»Ÿè®¾ç½®
          </p>
        </div>

        {showProductForm && renderProductForm()}
        {showStyleForm && renderStyleForm()}
        {showUserForm && renderUserForm()}
        {showPainPointForm && renderPainPointForm()}
        {showProductDetail && renderProductDetail()}
        {showRankingTuning && renderRankingTuning()}
        {showScrapingModal && renderScrapingModal()}
        {showSubmissionDetail && renderSubmissionDetail()}

        {!showProductForm && !showStyleForm && !showUserForm && !showPainPointForm && !showProductDetail && !showRankingTuning && !showSubmissionDetail && (
          <Tabs value={activeTab} onValueChange={setActiveTab} className="w-full">
            <TabsList className="grid w-full grid-cols-8">
              <TabsTrigger value="products" className="flex items-center gap-2">
                <Package className="h-4 w-4" />
                å•†å“åº“
              </TabsTrigger>
              <TabsTrigger value="styles" className="flex items-center gap-2">
                <Palette className="h-4 w-4" />
                é£æ ¼åº“
              </TabsTrigger>
              <TabsTrigger value="users" className="flex items-center gap-2">
                <Users className="h-4 w-4" />
                ç”¨æˆ·ç®¡ç†
              </TabsTrigger>
              <TabsTrigger value="user-submissions" className="flex items-center gap-2">
                <Upload className="h-4 w-4" />
                ç”¨æˆ·æäº¤
              </TabsTrigger>
              <TabsTrigger value="pain-points" className="flex items-center gap-2">
                <MessageSquare className="h-4 w-4" />
                ç—›ç‚¹åˆ†æ
              </TabsTrigger>
              <TabsTrigger value="sync" className="flex items-center gap-2">
                <Database className="h-4 w-4" />
                æ•°æ®åŒæ­¥
              </TabsTrigger>
              <TabsTrigger value="analytics" className="flex items-center gap-2">
                <BarChart3 className="h-4 w-4" />
                æ•°æ®åˆ†æ
              </TabsTrigger>
              <TabsTrigger value="ai-config" className="flex items-center gap-2">
                <Brain className="h-4 w-4" />
                AIé…ç½®
              </TabsTrigger>
            </TabsList>

            <TabsContent value="products" className="space-y-4">
              <div className="flex justify-between items-center">
                <h2 className="text-2xl font-semibold">å•†å“åº“ç®¡ç†</h2>
                <div className="flex gap-2">
                  <Button variant="outline" onClick={() => setShowBulkUpload(true)}>
                    <Upload className="h-4 w-4 mr-2" />
                    æ‰¹é‡ä¸Šä¼ 
                  </Button>
                  <Button onClick={() => setShowProductForm(true)}>
                    <Plus className="h-4 w-4 mr-2" />
                    æ·»åŠ å•†å“
                  </Button>
                </div>
              </div>

              <div className="border rounded-lg">
                <table className="w-full">
                  <thead className="bg-gray-50">
                    <tr>
                      <th className="px-4 py-3 text-left text-sm font-medium text-gray-900">å•†å“åç§°</th>
                      <th className="px-4 py-3 text-left text-sm font-medium text-gray-900">ç±»ç›®</th>
                      <th className="px-4 py-3 text-left text-sm font-medium text-gray-900">å–ç‚¹</th>
                      <th className="px-4 py-3 text-left text-sm font-medium text-gray-900">ç›®æ ‡å›½å®¶</th>
                      <th className="px-4 py-3 text-left text-sm font-medium text-gray-900">åˆ›å»ºæ—¶é—´</th>
                      <th className="px-4 py-3 text-left text-sm font-medium text-gray-900">æ“ä½œ</th>
                    </tr>
                  </thead>
                  <tbody className="divide-y divide-gray-200">
                    {products.map((product) => (
                      <tr key={product.id} className="hover:bg-gray-50">
                        <td className="px-4 py-3">
                          <div>
                            <div className="font-medium text-gray-900">{product.name}</div>
                            <div className="text-sm text-gray-500">{product.description}</div>
                          </div>
                        </td>
                        <td className="px-4 py-3">
                          <div className="flex gap-1">
                            <Badge variant="outline" className="text-xs">{product.category}</Badge>
                            {product.subcategory && (
                              <Badge variant="secondary" className="text-xs">{product.subcategory}</Badge>
                            )}
                          </div>
                        </td>
                        <td className="px-4 py-3">
                          <div className="text-sm text-gray-600 max-w-xs truncate">
                            {product.sellingPoints.join(', ')}
                          </div>
                        </td>
                        <td className="px-4 py-3">
                          <div className="flex flex-wrap gap-1">
                            {product.targetCountries.map((country) => (
                              <Badge key={country} variant="outline" className="text-xs">{country}</Badge>
                            ))}
                          </div>
                        </td>
                        <td className="px-4 py-3 text-sm text-gray-500">
                          {new Date(product.createdAt).toLocaleDateString()}
                        </td>
                        <td className="px-4 py-3">
                          <div className="flex gap-2">
                            <Button size="sm" variant="outline" onClick={() => handleEditProduct(product)}>
                              <Edit className="h-4 w-4" />
                            </Button>
                            <Button size="sm" variant="destructive" onClick={() => handleDeleteProduct(product.id)}>
                              <Trash2 className="h-4 w-4" />
                            </Button>
                          </div>
                        </td>
                      </tr>
                    ))}
                  </tbody>
                </table>
              </div>
            </TabsContent>

            <TabsContent value="styles" className="space-y-4">
              <div className="flex justify-between items-center">
                <h2 className="text-2xl font-semibold">é£æ ¼åº“ç®¡ç†</h2>
                <div className="flex gap-2">
                  <Button variant="outline" onClick={() => setShowRankingTuning(true)}>
                    <Settings className="h-4 w-4 mr-2" />
                    è°ƒå‚ä¼˜åŒ–
                  </Button>
                  <Button variant="outline" onClick={() => {/* TODO: æ‰¹é‡ä¸Šä¼ åŠŸèƒ½ */}}>
                    <Upload className="h-4 w-4 mr-2" />
                    æ‰¹é‡ä¸Šä¼ 
                  </Button>
                  <Button onClick={() => setShowStyleForm(true)}>
                    <Plus className="h-4 w-4 mr-2" />
                    æ·»åŠ é£æ ¼
                  </Button>
                </div>
              </div>

              <div className="border rounded-lg">
                <table className="w-full">
                  <thead className="bg-gray-50">
                    <tr>
                      <th className="px-4 py-3 text-left text-sm font-medium text-gray-900">é£æ ¼åç§°</th>
                      <th className="px-4 py-3 text-left text-sm font-medium text-gray-900">å…³è”å•†å“</th>
                      <th className="px-4 py-3 text-left text-sm font-medium text-gray-900">ç±»ç›®</th>
                      <th className="px-4 py-3 text-left text-sm font-medium text-gray-900">è¯­è°ƒ</th>
                      <th className="px-4 py-3 text-left text-sm font-medium text-gray-900">ç›®æ ‡å—ä¼—</th>
                      <th className="px-4 py-3 text-left text-sm font-medium text-gray-900">çŠ¶æ€</th>
                      <th className="px-4 py-3 text-left text-sm font-medium text-gray-900">æ“ä½œ</th>
                    </tr>
                  </thead>
                  <tbody className="divide-y divide-gray-200">
                    {styles.map((style) => (
                      <tr key={style.id} className="hover:bg-gray-50">
                        <td className="px-4 py-3">
                          <div>
                            <div className="font-medium text-gray-900">{style.name}</div>
                            <div className="text-sm text-gray-500">{style.description}</div>
                          </div>
                        </td>
                        <td className="px-4 py-3">
                          <div className="text-sm text-gray-900">{style.productName}</div>
                        </td>
                        <td className="px-4 py-3">
                          <div className="flex gap-1">
                            <Badge variant="outline" className="text-xs">{style.category}</Badge>
                            {style.subcategory && (
                              <Badge variant="secondary" className="text-xs">{style.subcategory}</Badge>
                            )}
                          </div>
                        </td>
                        <td className="px-4 py-3">
                          <Badge variant="outline" className="text-xs">{style.tone}</Badge>
                        </td>
                        <td className="px-4 py-3">
                          <div className="text-sm text-gray-600">
                            {style.targetAudience.age}å², {style.targetAudience.gender}
                          </div>
                        </td>
                        <td className="px-4 py-3">
                          <Badge variant={style.isActive ? "default" : "secondary"}>
                            {style.isActive ? 'å¯ç”¨' : 'ç¦ç”¨'}
                          </Badge>
                        </td>
                        <td className="px-4 py-3">
                          <div className="flex gap-2">
                            <Button size="sm" variant="outline" onClick={() => handleEditStyle(style)}>
                              <Edit className="h-4 w-4" />
                            </Button>
                            <Button size="sm" variant="destructive" onClick={() => handleDeleteStyle(style.id)}>
                              <Trash2 className="h-4 w-4" />
                            </Button>
                          </div>
                        </td>
                      </tr>
                    ))}
                  </tbody>
                </table>
              </div>
            </TabsContent>

            <TabsContent value="users" className="space-y-4">
              <div className="flex justify-between items-center">
                <h2 className="text-2xl font-semibold">ç”¨æˆ·ç®¡ç†</h2>
                <Button onClick={() => setShowUserForm(true)}>
                  <Plus className="h-4 w-4 mr-2" />
                  æ·»åŠ ç”¨æˆ·
                </Button>
              </div>

              <div className="border rounded-lg">
                <table className="w-full">
                  <thead className="bg-gray-50">
                    <tr>
                      <th className="px-4 py-3 text-left text-sm font-medium text-gray-900">ç”¨æˆ·ä¿¡æ¯</th>
                      <th className="px-4 py-3 text-left text-sm font-medium text-gray-900">è§’è‰²</th>
                      <th className="px-4 py-3 text-left text-sm font-medium text-gray-900">çŠ¶æ€</th>
                      <th className="px-4 py-3 text-left text-sm font-medium text-gray-900">è§†é¢‘æ•°</th>
                      <th className="px-4 py-3 text-left text-sm font-medium text-gray-900">åˆ›å»ºæ—¶é—´</th>
                      <th className="px-4 py-3 text-left text-sm font-medium text-gray-900">æ“ä½œ</th>
                    </tr>
                  </thead>
                  <tbody className="divide-y divide-gray-200">
                    {users.map((user) => (
                      <tr key={user.id} className="hover:bg-gray-50">
                        <td className="px-4 py-3">
                          <div>
                            <div className="font-medium text-gray-900">{user.name}</div>
                            <div className="text-sm text-gray-500">{user.email}</div>
                          </div>
                        </td>
                        <td className="px-4 py-3">
                          <Badge variant="outline" className="text-xs">
                            {user.role === 'admin' ? 'ç®¡ç†å‘˜' : 
                             user.role === 'manager' ? 'ç»ç†' :
                             user.role === 'operator' ? 'æ“ä½œå‘˜' : 'æŸ¥çœ‹è€…'}
                          </Badge>
                        </td>
                        <td className="px-4 py-3">
                          <Badge variant={user.isActive ? "default" : "secondary"}>
                            {user.isActive ? 'æ´»è·ƒ' : 'ç¦ç”¨'}
                          </Badge>
                        </td>
                        <td className="px-4 py-3 text-sm text-gray-900">{user._count.videos}</td>
                        <td className="px-4 py-3 text-sm text-gray-500">
                          {new Date(user.createdAt).toLocaleDateString()}
                        </td>
                        <td className="px-4 py-3">
                          <div className="flex gap-2">
                            <Button size="sm" variant="outline" onClick={() => handleEditUser(user)}>
                              <Edit className="h-4 w-4" />
                            </Button>
                            <Button size="sm" variant="destructive" onClick={() => handleDeleteUser(user.id)}>
                              <Trash2 className="h-4 w-4" />
                            </Button>
                          </div>
                        </td>
                      </tr>
                    ))}
                  </tbody>
                </table>
              </div>
            </TabsContent>

            <TabsContent value="user-submissions" className="space-y-4">
              <div className="flex justify-between items-center">
                <h2 className="text-2xl font-semibold">ç”¨æˆ·æäº¤ç®¡ç†</h2>
                <div className="flex gap-2">
                  <Button variant="outline" onClick={() => loadUserSubmissions()}>
                    <RefreshCw className="h-4 w-4 mr-2" />
                    åˆ·æ–°
                  </Button>
                </div>
              </div>

              <div className="border rounded-lg">
                <table className="w-full">
                  <thead className="bg-gray-50">
                    <tr>
                      <th className="px-4 py-3 text-left text-sm font-medium text-gray-900">ç±»å‹</th>
                      <th className="px-4 py-3 text-left text-sm font-medium text-gray-900">æ¥æº</th>
                      <th className="px-4 py-3 text-left text-sm font-medium text-gray-900">çŠ¶æ€</th>
                      <th className="px-4 py-3 text-left text-sm font-medium text-gray-900">æäº¤æ—¶é—´</th>
                      <th className="px-4 py-3 text-left text-sm font-medium text-gray-900">æ“ä½œ</th>
                    </tr>
                  </thead>
                  <tbody className="divide-y divide-gray-200">
                    {userSubmissions.map((submission) => (
                      <tr key={submission.id} className="hover:bg-gray-50">
                        <td className="px-4 py-3">
                          <Badge variant="outline" className="text-xs">
                            {submission.type === 'style' ? 'é£æ ¼' : 'å•†å“'}
                          </Badge>
                        </td>
                        <td className="px-4 py-3">
                          <div className="text-sm">
                            <div className="font-medium text-gray-900">
                              {submission.source === 'user_video_analysis' ? 'ç”¨æˆ·è§†é¢‘è§£æ' :
                               submission.source === 'user_modified' ? 'ç”¨æˆ·ä¿®æ”¹' :
                               submission.source === 'user_analysis' ? 'ç”¨æˆ·åˆ†æ' : 'æ‰‹åŠ¨ä¸Šä¼ '}
                            </div>
                            {submission.sourceUrl && (
                              <div className="text-xs text-gray-500 truncate max-w-xs">
                                {submission.sourceUrl}
                              </div>
                            )}
                          </div>
                        </td>
                        <td className="px-4 py-3">
                          <Badge variant={
                            submission.status === 'pending' ? 'secondary' :
                            submission.status === 'approved' ? 'default' : 'destructive'
                          }>
                            {submission.status === 'pending' ? 'å¾…å®¡æ ¸' :
                             submission.status === 'approved' ? 'å·²é€šè¿‡' : 'å·²æ‹’ç»'}
                          </Badge>
                        </td>
                        <td className="px-4 py-3 text-sm text-gray-500">
                          {new Date(submission.createdAt).toLocaleString()}
                        </td>
                        <td className="px-4 py-3">
                          <div className="flex gap-2">
                            <Button size="sm" variant="outline" onClick={() => handleViewSubmission(submission)}>
                              æŸ¥çœ‹è¯¦æƒ…
                            </Button>
                            {submission.status === 'pending' && (
                              <>
                                <Button size="sm" variant="default" onClick={() => handleReviewSubmission(submission.id, 'approved')}>
                                  é€šè¿‡
                                </Button>
                                <Button size="sm" variant="destructive" onClick={() => handleReviewSubmission(submission.id, 'rejected')}>
                                  æ‹’ç»
                                </Button>
                              </>
                            )}
                          </div>
                        </td>
                      </tr>
                    ))}
                  </tbody>
                </table>
              </div>
            </TabsContent>

            <TabsContent value="pain-points" className="space-y-4">
              <div className="flex justify-between items-center">
                <h2 className="text-2xl font-semibold">äº§å“ç—›ç‚¹åˆ†æ</h2>
                <div className="flex gap-2">
                  <Button variant="outline" onClick={() => setShowScrapingModal(true)}>
                    <Search className="h-4 w-4 mr-2" />
                    å¼€å§‹çˆ¬å–
                  </Button>
                  <Button onClick={() => setShowPainPointForm(true)}>
                    <Plus className="h-4 w-4 mr-2" />
                    æ‰‹åŠ¨æ·»åŠ 
                  </Button>
                </div>
              </div>

              <div className="border rounded-lg">
                <table className="w-full">
                  <thead className="bg-gray-50">
                    <tr>
                      <th className="px-4 py-3 text-left text-sm font-medium text-gray-900">äº§å“ä¿¡æ¯</th>
                      <th className="px-4 py-3 text-left text-sm font-medium text-gray-900">å¹³å°</th>
                      <th className="px-4 py-3 text-left text-sm font-medium text-gray-900">ç—›ç‚¹</th>
                      <th className="px-4 py-3 text-left text-sm font-medium text-gray-900">ä¸¥é‡ç¨‹åº¦</th>
                      <th className="px-4 py-3 text-left text-sm font-medium text-gray-900">æƒ…æ„Ÿ</th>
                      <th className="px-4 py-3 text-left text-sm font-medium text-gray-900">è¯„è®ºæ•°</th>
                      <th className="px-4 py-3 text-left text-sm font-medium text-gray-900">æ“ä½œ</th>
                    </tr>
                  </thead>
                  <tbody className="divide-y divide-gray-200">
                    {painPoints.map((painPoint) => (
                      <tr key={painPoint.id} className="hover:bg-gray-50">
                        <td className="px-4 py-3">
                          <div>
                            <div className="font-medium text-gray-900">{painPoint.productName}</div>
                            <div className="text-sm text-gray-500">{painPoint.product.category}</div>
                          </div>
                        </td>
                        <td className="px-4 py-3">
                          <Badge variant="outline" className="text-xs">
                            {painPoint.platform}
                          </Badge>
                        </td>
                        <td className="px-4 py-3">
                          <div className="text-sm text-gray-600 max-w-xs">
                            {painPoint.painPoints.slice(0, 2).join(', ')}
                            {painPoint.painPoints.length > 2 && '...'}
                          </div>
                        </td>
                        <td className="px-4 py-3">
                          <Badge 
                            variant={painPoint.severity === 'high' ? 'destructive' : 
                                    painPoint.severity === 'medium' ? 'default' : 'secondary'}
                            className="text-xs"
                          >
                            {painPoint.severity === 'high' ? 'é«˜' : 
                             painPoint.severity === 'medium' ? 'ä¸­' : 'ä½'}
                          </Badge>
                        </td>
                        <td className="px-4 py-3">
                          <Badge 
                            variant={painPoint.sentiment === 'negative' ? 'destructive' : 
                                    painPoint.sentiment === 'positive' ? 'default' : 'secondary'}
                            className="text-xs"
                          >
                            {painPoint.sentiment === 'negative' ? 'è´Ÿé¢' : 
                             painPoint.sentiment === 'positive' ? 'æ­£é¢' : 'ä¸­æ€§'}
                          </Badge>
                        </td>
                        <td className="px-4 py-3 text-sm text-gray-900">{painPoint._count.comments}</td>
                        <td className="px-4 py-3">
                          <div className="flex gap-2">
                            <Button size="sm" variant="outline" onClick={() => handleAIAnalyze(painPoint.id)}>
                              <Brain className="h-4 w-4" />
                            </Button>
                            <Button size="sm" variant="destructive">
                              <Trash2 className="h-4 w-4" />
                            </Button>
                          </div>
                        </td>
                      </tr>
                    ))}
                  </tbody>
                </table>
              </div>
            </TabsContent>

            <TabsContent value="sync" className="space-y-4">
              <div className="flex justify-between items-center">
                <h2 className="text-2xl font-semibold">æ•°æ®åŒæ­¥</h2>
                <Button 
                  onClick={handleSyncSheets}
                  disabled={isSyncing}
                  className="bg-blue-600 hover:bg-blue-700"
                >
                  {isSyncing ? (
                    <>
                      <RefreshCw className="h-4 w-4 mr-2 animate-spin" />
                      åŒæ­¥ä¸­...
                    </>
                  ) : (
                    <>
                      <RefreshCw className="h-4 w-4 mr-2" />
                      åŒæ­¥Google Sheets
                    </>
                  )}
                </Button>
              </div>

              <div className="grid gap-4">
                <Card>
                  <CardHeader>
                    <CardTitle>Google Sheets é…ç½®</CardTitle>
                  </CardHeader>
                  <CardContent className="space-y-4">
                    <div>
                      <Label className="text-sm font-medium">Google Sheets é“¾æ¥</Label>
                      <div className="mt-1 p-3 bg-gray-50 rounded-lg">
                        <a 
                          href="https://docs.google.com/spreadsheets/d/1q_ZqVw4DVRbcAA78ZVndXq4XcFEySNmRoLHiFkllFls" 
                          target="_blank" 
                          rel="noopener noreferrer"
                          className="text-blue-600 hover:underline"
                        >
                          https://docs.google.com/spreadsheets/d/1q_ZqVw4DVRbcAA78ZVndXq4XcFEySNmRoLHiFkllFls
                        </a>
                      </div>
                    </div>
                    
                    <div>
                      <Label className="text-sm font-medium">å­—æ®µè¦æ±‚</Label>
                      <div className="mt-2 space-y-2">
                        <div className="text-sm text-gray-600">
                          <strong>å¿…éœ€å­—æ®µï¼š</strong>
                        </div>
                        <ul className="text-sm text-gray-600 ml-4 space-y-1">
                          <li>â€¢ TemplateID: æ¨¡æ¿å”¯ä¸€æ ‡è¯† (å¦‚: TMP001)</li>
                          <li>â€¢ TemplateName: æ¨¡æ¿åç§°</li>
                          <li>â€¢ ProductId: å…³è”å•†å“ID</li>
                          <li>â€¢ Structure: è„šæœ¬ç»“æ„</li>
                          <li>â€¢ HookPool: Hookæ± </li>
                          <li>â€¢ VideoStylePool: è§†é¢‘é£æ ¼æ± </li>
                          <li>â€¢ TonePool: è¯­è°ƒæ± </li>
                          <li>â€¢ SuggestedLength: å»ºè®®æ—¶é•¿</li>
                          <li>â€¢ RecommendedCategories: æ¨èç±»ç›®</li>
                          <li>â€¢ TargetCountries: ç›®æ ‡å›½å®¶</li>
                          <li>â€¢ TemplatePrompt: æ¨¡æ¿æç¤ºè¯</li>
                        </ul>
                      </div>
                    </div>
                  </CardContent>
                </Card>

                {syncResult && (
                  <Card>
                    <CardHeader>
                      <CardTitle>åŒæ­¥ç»“æœ</CardTitle>
                    </CardHeader>
                    <CardContent className="space-y-4">
                      <div className="grid grid-cols-2 md:grid-cols-4 gap-4">
                        <div className="text-center">
                          <div className="text-2xl font-bold text-blue-600">{syncResult.totalTemplates}</div>
                          <div className="text-sm text-gray-600">æ€»æ¨¡æ¿æ•°</div>
                        </div>
                        <div className="text-center">
                          <div className="text-2xl font-bold text-green-600">{syncResult.createdCount}</div>
                          <div className="text-sm text-gray-600">æ–°å¢</div>
                        </div>
                        <div className="text-center">
                          <div className="text-2xl font-bold text-orange-600">{syncResult.updatedCount}</div>
                          <div className="text-sm text-gray-600">æ›´æ–°</div>
                        </div>
                        <div className="text-center">
                          <div className="text-2xl font-bold text-red-600">{syncResult.duplicatesFound}</div>
                          <div className="text-sm text-gray-600">é‡å¤æ£€æµ‹</div>
                        </div>
                      </div>

                      {syncResult.duplicates && syncResult.duplicates.length > 0 && (
                        <div>
                          <h4 className="font-medium mb-2">æ£€æµ‹åˆ°çš„é‡å¤æ¨¡æ¿ï¼š</h4>
                          <div className="space-y-2">
                            {syncResult.duplicates.map((dup: any, index: number) => (
                              <div key={index} className="bg-yellow-50 p-3 rounded-lg">
                                <div className="flex justify-between items-center">
                                  <span className="text-sm">
                                    {dup.template1} â†” {dup.template2}
                                  </span>
                                  <Badge variant="outline">ç›¸ä¼¼åº¦: {dup.similarity}%</Badge>
                                </div>
                                <div className="text-xs text-gray-600 mt-1">
                                  åŸå› : {dup.reasons.join(', ')}
                                </div>
                              </div>
                            ))}
                          </div>
                        </div>
                      )}
                    </CardContent>
                  </Card>
                )}

                <Card>
                  <CardHeader>
                    <CardTitle>åŒæ­¥è¯´æ˜</CardTitle>
                  </CardHeader>
                  <CardContent>
                    <ul className="space-y-2 text-sm text-gray-600">
                      <li>â€¢ ä»Google Sheetsè‡ªåŠ¨åŒæ­¥æ¨¡æ¿æ•°æ®</li>
                      <li>â€¢ è‡ªåŠ¨æ£€æµ‹é‡å¤æ¨¡æ¿ï¼ˆç›¸ä¼¼åº¦â‰¥80%ï¼‰</li>
                      <li>â€¢ æ™ºèƒ½åˆå¹¶ç›¸ä¼¼æ¨¡æ¿çš„Hookæ± ã€é£æ ¼æ± ç­‰</li>
                      <li>â€¢ ä¿æŒæ•°æ®ä¸€è‡´æ€§å’Œå»é‡</li>
                    </ul>
                  </CardContent>
                </Card>
              </div>
            </TabsContent>

            <TabsContent value="analytics" className="space-y-4">
              <div className="flex justify-between items-center">
                <h2 className="text-2xl font-semibold">æ•°æ®åˆ†æçœ‹æ¿</h2>
                <div className="flex gap-2">
                  <Button variant="outline" onClick={() => {/* TODO: å¯¼å‡ºåŠŸèƒ½ */}}>
                    <Database className="h-4 w-4 mr-2" />
                    å¯¼å‡ºæ•°æ®
                  </Button>
                  <Button onClick={() => {/* TODO: åˆ·æ–°æ•°æ® */}}>
                    <RefreshCw className="h-4 w-4 mr-2" />
                    åˆ·æ–°æ•°æ®
                  </Button>
                </div>
              </div>

              {/* ç­›é€‰å™¨ */}
              <Card>
                <CardHeader>
                  <CardTitle>æ•°æ®ç­›é€‰</CardTitle>
                  <CardDescription>é€‰æ‹©æ—¶é—´èŒƒå›´ã€å•†å“ã€å¹³å°å’Œæ¨¡æ¿è¿›è¡Œæ•°æ®ç­›é€‰</CardDescription>
                </CardHeader>
                <CardContent>
                  <div className="grid grid-cols-1 md:grid-cols-4 gap-4">
                    <div>
                      <Label className="text-sm font-medium">æ—¶é—´èŒƒå›´</Label>
                      <Select value={filters.dateRange} onValueChange={(value) => handleFilterChange('dateRange', value)}>
                        <SelectTrigger>
                          <SelectValue placeholder="é€‰æ‹©æ—¶é—´èŒƒå›´" />
                        </SelectTrigger>
                        <SelectContent>
                          <SelectItem value="1d">æœ€è¿‘1å¤©</SelectItem>
                          <SelectItem value="7d">æœ€è¿‘7å¤©</SelectItem>
                          <SelectItem value="30d">æœ€è¿‘30å¤©</SelectItem>
                          <SelectItem value="90d">æœ€è¿‘90å¤©</SelectItem>
                          <SelectItem value="custom">è‡ªå®šä¹‰</SelectItem>
                        </SelectContent>
                      </Select>
                    </div>
                    
                    <div>
                      <Label className="text-sm font-medium">å•†å“</Label>
                      <Select value={filters.product} onValueChange={(value) => handleFilterChange('product', value)}>
                        <SelectTrigger>
                          <SelectValue placeholder="é€‰æ‹©å•†å“" />
                        </SelectTrigger>
                        <SelectContent>
                          <SelectItem value="all">å…¨éƒ¨å•†å“</SelectItem>
                          <SelectItem value="earphone">æ— çº¿è“ç‰™è€³æœº</SelectItem>
                          <SelectItem value="watch">æ™ºèƒ½æ‰‹è¡¨</SelectItem>
                          <SelectItem value="speaker">è“ç‰™éŸ³ç®±</SelectItem>
                        </SelectContent>
                      </Select>
                    </div>
                    
                    <div>
                      <Label className="text-sm font-medium">å¹³å°</Label>
                      <Select value={filters.platform} onValueChange={(value) => handleFilterChange('platform', value)}>
                        <SelectTrigger>
                          <SelectValue placeholder="é€‰æ‹©å¹³å°" />
                        </SelectTrigger>
                        <SelectContent>
                          <SelectItem value="all">å…¨éƒ¨å¹³å°</SelectItem>
                          <SelectItem value="tiktok">TikTok</SelectItem>
                          <SelectItem value="instagram">Instagram</SelectItem>
                          <SelectItem value="youtube">YouTube</SelectItem>
                          <SelectItem value="facebook">Facebook</SelectItem>
                        </SelectContent>
                      </Select>
                    </div>
                    
                    <div>
                      <Label className="text-sm font-medium">æ¨¡æ¿</Label>
                      <Select value={filters.template} onValueChange={(value) => handleFilterChange('template', value)}>
                        <SelectTrigger>
                          <SelectValue placeholder="é€‰æ‹©æ¨¡æ¿" />
                        </SelectTrigger>
                        <SelectContent>
                          <SelectItem value="all">å…¨éƒ¨æ¨¡æ¿</SelectItem>
                          <SelectItem value="tech">ç§‘æŠ€æ„Ÿé£æ ¼</SelectItem>
                          <SelectItem value="fashion">æ—¶å°šç¾å¦†é£æ ¼</SelectItem>
                          <SelectItem value="lifestyle">ç”Ÿæ´»æ–¹å¼é£æ ¼</SelectItem>
                        </SelectContent>
                      </Select>
                    </div>
                  </div>
                </CardContent>
              </Card>

              <div className="grid gap-4">
                {/* æ€»è§ˆæŒ‡æ ‡ */}
                <div className="grid grid-cols-1 md:grid-cols-4 gap-4">
                  <Card>
                    <CardContent className="p-6">
                      <div className="text-center">
                        <div className="text-3xl font-bold text-blue-600">$12,345</div>
                        <div className="text-sm text-gray-600">æ€»èŠ±è´¹</div>
                        <div className="text-xs text-green-600 mt-1">+12.5%</div>
                      </div>
                    </CardContent>
                  </Card>
                  <Card>
                    <CardContent className="p-6">
                      <div className="text-center">
                        <div className="text-3xl font-bold text-green-600">$45,678</div>
                        <div className="text-sm text-gray-600">æ€»GMV</div>
                        <div className="text-xs text-green-600 mt-1">+8.3%</div>
                      </div>
                    </CardContent>
                  </Card>
                  <Card>
                    <CardContent className="p-6">
                      <div className="text-center">
                        <div className="text-3xl font-bold text-purple-600">1,234</div>
                        <div className="text-sm text-gray-600">æ€»æ’­æ”¾</div>
                        <div className="text-xs text-green-600 mt-1">+15.2%</div>
                      </div>
                    </CardContent>
                  </Card>
                  <Card>
                    <CardContent className="p-6">
                      <div className="text-center">
                        <div className="text-3xl font-bold text-orange-600">3.2%</div>
                        <div className="text-sm text-gray-600">å¹³å‡CTR</div>
                        <div className="text-xs text-red-600 mt-1">-0.5%</div>
                      </div>
                    </CardContent>
                  </Card>
                </div>

                {/* è¶‹åŠ¿å›¾ */}
                <Card>
                  <CardHeader>
                    <CardTitle>æ•°æ®è¶‹åŠ¿å›¾</CardTitle>
                    <CardDescription>å…³é”®æŒ‡æ ‡çš„æ—¶é—´è¶‹åŠ¿åˆ†æ</CardDescription>
                  </CardHeader>
                  <CardContent>
                    <div className="h-80 bg-gray-50 rounded-lg flex items-center justify-center">
                      <div className="text-center">
                        <div className="text-4xl mb-4">ğŸ“ˆ</div>
                        <div className="text-lg font-medium text-gray-700">è¶‹åŠ¿å›¾</div>
                        <div className="text-sm text-gray-500 mt-2">
                          èŠ±è´¹: $1,200 â†’ $1,400 â†’ $1,100 â†’ $1,350 â†’ $1,280 â†’ $1,450 â†’ $1,320
                        </div>
                        <div className="text-sm text-gray-500 mt-1">
                          GMV: $4,500 â†’ $5,200 â†’ $3,800 â†’ $5,800 â†’ $4,900 â†’ $5,600 â†’ $4,800
                        </div>
                        <div className="text-sm text-gray-500 mt-1">
                          æ’­æ”¾: 25 â†’ 30 â†’ 22 â†’ 35 â†’ 28 â†’ 32 â†’ 26
                        </div>
                        <div className="text-xs text-gray-400 mt-4">
                          * å®é™…é¡¹ç›®ä¸­å¯é›†æˆ Chart.js æˆ– Recharts ç­‰å›¾è¡¨åº“
                        </div>
                      </div>
                    </div>
                  </CardContent>
                </Card>

                {/* å•†å“è¡¨ç°è¡¨æ ¼ */}
                <Card>
                  <CardHeader>
                    <CardTitle>å•†å“è¡¨ç°æ’è¡Œ</CardTitle>
                  </CardHeader>
                  <CardContent>
                    <div className="border rounded-lg">
                      <table className="w-full">
                        <thead className="bg-gray-50">
                          <tr>
                            <th className="px-4 py-3 text-left text-sm font-medium text-gray-900">å•†å“åç§°</th>
                            <th className="px-4 py-3 text-left text-sm font-medium text-gray-900">èŠ±è´¹</th>
                            <th className="px-4 py-3 text-left text-sm font-medium text-gray-900">GMV</th>
                            <th className="px-4 py-3 text-left text-sm font-medium text-gray-900">æ’­æ”¾</th>
                            <th className="px-4 py-3 text-left text-sm font-medium text-gray-900">CTR</th>
                            <th className="px-4 py-3 text-left text-sm font-medium text-gray-900">ROI</th>
                            <th className="px-4 py-3 text-left text-sm font-medium text-gray-900">æ“ä½œ</th>
                          </tr>
                        </thead>
                        <tbody className="divide-y divide-gray-200">
                          <tr className="hover:bg-gray-50 cursor-pointer">
                            <td className="px-4 py-3">
                              <div className="font-medium text-gray-900">æ— çº¿è“ç‰™è€³æœº</div>
                              <div className="text-sm text-gray-500">ç”µå­äº§å“</div>
                            </td>
                            <td className="px-4 py-3 text-sm text-gray-900">$2,345</td>
                            <td className="px-4 py-3 text-sm text-gray-900">$8,765</td>
                            <td className="px-4 py-3 text-sm text-gray-900">456</td>
                            <td className="px-4 py-3 text-sm text-gray-900">3.2%</td>
                            <td className="px-4 py-3 text-sm text-gray-900">3.7x</td>
                            <td className="px-4 py-3">
                              <Button size="sm" variant="outline" onClick={() => handleViewProductDetail('æ— çº¿è“ç‰™è€³æœº')}>
                                æŸ¥çœ‹è¯¦æƒ…
                              </Button>
                            </td>
                          </tr>
                          <tr className="hover:bg-gray-50 cursor-pointer">
                            <td className="px-4 py-3">
                              <div className="font-medium text-gray-900">æ™ºèƒ½æ‰‹è¡¨</div>
                              <div className="text-sm text-gray-500">ç”µå­äº§å“</div>
                            </td>
                            <td className="px-4 py-3 text-sm text-gray-900">$1,876</td>
                            <td className="px-4 py-3 text-sm text-gray-900">$6,543</td>
                            <td className="px-4 py-3 text-sm text-gray-900">321</td>
                            <td className="px-4 py-3 text-sm text-gray-900">2.8%</td>
                            <td className="px-4 py-3 text-sm text-gray-900">3.5x</td>
                            <td className="px-4 py-3">
                              <Button size="sm" variant="outline" onClick={() => handleViewProductDetail('æ™ºèƒ½æ‰‹è¡¨')}>
                                æŸ¥çœ‹è¯¦æƒ…
                              </Button>
                            </td>
                          </tr>
                        </tbody>
                      </table>
                    </div>
                  </CardContent>
                </Card>
              </div>
            </TabsContent>

            <TabsContent value="ai-config" className="space-y-4">
              <div className="flex justify-between items-center">
                <h2 className="text-2xl font-semibold">AIé…ç½®ç®¡ç†</h2>
                <Button onClick={() => {/* TODO: ä¿å­˜é…ç½® */}}>
                  <Brain className="h-4 w-4 mr-2" />
                  ä¿å­˜é…ç½®
                </Button>
              </div>

              <div className="grid gap-4">
                {/* å…¨å±€é…ç½® */}
                <Card>
                  <CardHeader>
                    <CardTitle>å…¨å±€AIé…ç½®</CardTitle>
                    <CardDescription>ç³»ç»Ÿé»˜è®¤çš„AIæœåŠ¡é…ç½®</CardDescription>
                  </CardHeader>
                  <CardContent className="space-y-4">
                    <div className="grid grid-cols-1 md:grid-cols-3 gap-4">
                      <div>
                        <Label className="text-sm font-medium">è§†é¢‘åˆ†æAI</Label>
                        <Select defaultValue="gemini">
                          <SelectTrigger>
                            <SelectValue placeholder="é€‰æ‹©AIæœåŠ¡" />
                          </SelectTrigger>
                          <SelectContent>
                            <SelectItem value="gemini">Gemini</SelectItem>
                            <SelectItem value="gpt4">GPT-4</SelectItem>
                            <SelectItem value="claude">Claude</SelectItem>
                          </SelectContent>
                        </Select>
                      </div>
                      <div>
                        <Label className="text-sm font-medium">Promptç”ŸæˆAI</Label>
                        <Select defaultValue="gemini">
                          <SelectTrigger>
                            <SelectValue placeholder="é€‰æ‹©AIæœåŠ¡" />
                          </SelectTrigger>
                          <SelectContent>
                            <SelectItem value="gemini">Gemini</SelectItem>
                            <SelectItem value="gpt4">GPT-4</SelectItem>
                            <SelectItem value="claude">Claude</SelectItem>
                          </SelectContent>
                        </Select>
                      </div>
                      <div>
                        <Label className="text-sm font-medium">è§†é¢‘ç”ŸæˆAI</Label>
                        <Select defaultValue="sora">
                          <SelectTrigger>
                            <SelectValue placeholder="é€‰æ‹©AIæœåŠ¡" />
                          </SelectTrigger>
                          <SelectContent>
                            <SelectItem value="sora">Sora</SelectItem>
                            <SelectItem value="veo">Veo</SelectItem>
                            <SelectItem value="doubao">è±†åŒ…</SelectItem>
                          </SelectContent>
                        </Select>
                      </div>
                    </div>
                  </CardContent>
                </Card>

                {/* æ¨¡æ¿AIé…ç½® */}
                <Card>
                  <CardHeader>
                    <CardTitle>æ¨¡æ¿AIé…ç½®</CardTitle>
                    <CardDescription>ä¸ºä¸åŒæ¨¡æ¿é…ç½®ä¸“ç”¨çš„AIæœåŠ¡ï¼Œç”¨äºæ•°æ®å½’å› å’Œä¼˜åŒ–</CardDescription>
                  </CardHeader>
                  <CardContent>
                    <div className="border rounded-lg">
                      <table className="w-full">
                        <thead className="bg-gray-50">
                          <tr>
                            <th className="px-4 py-3 text-left text-sm font-medium text-gray-900">æ¨¡æ¿åç§°</th>
                            <th className="px-4 py-3 text-left text-sm font-medium text-gray-900">è§†é¢‘åˆ†æAI</th>
                            <th className="px-4 py-3 text-left text-sm font-medium text-gray-900">Promptç”ŸæˆAI</th>
                            <th className="px-4 py-3 text-left text-sm font-medium text-gray-900">è§†é¢‘ç”ŸæˆAI</th>
                            <th className="px-4 py-3 text-left text-sm font-medium text-gray-900">æ“ä½œ</th>
                          </tr>
                        </thead>
                        <tbody className="divide-y divide-gray-200">
                          <tr>
                            <td className="px-4 py-3">
                              <div className="font-medium text-gray-900">ç§‘æŠ€æ„Ÿé£æ ¼</div>
                              <div className="text-sm text-gray-500">ç”µå­äº§å“</div>
                            </td>
                            <td className="px-4 py-3">
                              <Select defaultValue="gemini">
                                <SelectTrigger className="w-32">
                                  <SelectValue />
                                </SelectTrigger>
                                <SelectContent>
                                  <SelectItem value="gemini">Gemini</SelectItem>
                                  <SelectItem value="gpt4">GPT-4</SelectItem>
                                  <SelectItem value="claude">Claude</SelectItem>
                                </SelectContent>
                              </Select>
                            </td>
                            <td className="px-4 py-3">
                              <Select defaultValue="gpt4">
                                <SelectTrigger className="w-32">
                                  <SelectValue />
                                </SelectTrigger>
                                <SelectContent>
                                  <SelectItem value="gemini">Gemini</SelectItem>
                                  <SelectItem value="gpt4">GPT-4</SelectItem>
                                  <SelectItem value="claude">Claude</SelectItem>
                                </SelectContent>
                              </Select>
                            </td>
                            <td className="px-4 py-3">
                              <Select defaultValue="sora">
                                <SelectTrigger className="w-32">
                                  <SelectValue />
                                </SelectTrigger>
                                <SelectContent>
                                  <SelectItem value="sora">Sora</SelectItem>
                                  <SelectItem value="veo">Veo</SelectItem>
                                  <SelectItem value="doubao">è±†åŒ…</SelectItem>
                                </SelectContent>
                              </Select>
                            </td>
                            <td className="px-4 py-3">
                              <Button size="sm" variant="outline">
                                ä¿å­˜
                              </Button>
                            </td>
                          </tr>
                          <tr>
                            <td className="px-4 py-3">
                              <div className="font-medium text-gray-900">æ—¶å°šç¾å¦†é£æ ¼</div>
                              <div className="text-sm text-gray-500">ç¾å¦†æŠ¤è‚¤</div>
                            </td>
                            <td className="px-4 py-3">
                              <Select defaultValue="claude">
                                <SelectTrigger className="w-32">
                                  <SelectValue />
                                </SelectTrigger>
                                <SelectContent>
                                  <SelectItem value="gemini">Gemini</SelectItem>
                                  <SelectItem value="gpt4">GPT-4</SelectItem>
                                  <SelectItem value="claude">Claude</SelectItem>
                                </SelectContent>
                              </Select>
                            </td>
                            <td className="px-4 py-3">
                              <Select defaultValue="claude">
                                <SelectTrigger className="w-32">
                                  <SelectValue />
                                </SelectTrigger>
                                <SelectContent>
                                  <SelectItem value="gemini">Gemini</SelectItem>
                                  <SelectItem value="gpt4">GPT-4</SelectItem>
                                  <SelectItem value="claude">Claude</SelectItem>
                                </SelectContent>
                              </Select>
                            </td>
                            <td className="px-4 py-3">
                              <Select defaultValue="veo">
                                <SelectTrigger className="w-32">
                                  <SelectValue />
                                </SelectTrigger>
                                <SelectContent>
                                  <SelectItem value="sora">Sora</SelectItem>
                                  <SelectItem value="veo">Veo</SelectItem>
                                  <SelectItem value="doubao">è±†åŒ…</SelectItem>
                                </SelectContent>
                              </Select>
                            </td>
                            <td className="px-4 py-3">
                              <Button size="sm" variant="outline">
                                ä¿å­˜
                              </Button>
                            </td>
                          </tr>
                        </tbody>
                      </table>
                    </div>
                  </CardContent>
                </Card>

                {/* é…ç½®è¯´æ˜ */}
                <Card>
                  <CardHeader>
                    <CardTitle>é…ç½®è¯´æ˜</CardTitle>
                  </CardHeader>
                  <CardContent>
                    <div className="space-y-2 text-sm text-gray-600">
                      <p><strong>å…¨å±€é…ç½®ï¼š</strong>ç³»ç»Ÿé»˜è®¤çš„AIæœåŠ¡é…ç½®ï¼Œé€‚ç”¨äºæ‰€æœ‰æ¨¡æ¿</p>
                      <p><strong>æ¨¡æ¿é…ç½®ï¼š</strong>ä¸ºç‰¹å®šæ¨¡æ¿é…ç½®ä¸“ç”¨çš„AIæœåŠ¡ï¼Œç”¨äºï¼š</p>
                      <ul className="ml-4 space-y-1">
                        <li>â€¢ æ•°æ®å½’å› ï¼šåˆ†æä¸åŒAIç»„åˆçš„æ•ˆæœ</li>
                        <li>â€¢ æ€§èƒ½ä¼˜åŒ–ï¼šæ ¹æ®å†å²æ•°æ®é€‰æ‹©æœ€ä½³AIç»„åˆ</li>
                        <li>â€¢ ä¸ªæ€§åŒ–åŒ¹é…ï¼šä¸åŒé£æ ¼é€‚åˆä¸åŒçš„AIæœåŠ¡</li>
                      </ul>
                      <p><strong>æœªæ¥ç›®æ ‡ï¼š</strong>AIå°†æ ¹æ®å•†å“ä¿¡æ¯è‡ªåŠ¨é€‰æ‹©æœ€ä¼˜çš„AIç»„åˆ</p>
                    </div>
                  </CardContent>
                </Card>
              </div>
            </TabsContent>
          </Tabs>
        )}
      </div>

      {/* æ‰¹é‡ä¸Šä¼ æ¨¡æ€æ¡† */}
      {showBulkUpload && (
        <div className="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50">
          <Card className="w-full max-w-md mx-4">
            <CardHeader>
              <CardTitle>æ‰¹é‡ä¸Šä¼ å•†å“</CardTitle>
              <CardDescription>
                ä¸Šä¼ CSVæ–‡ä»¶æ‰¹é‡å¯¼å…¥å•†å“æ•°æ®
              </CardDescription>
            </CardHeader>
            <CardContent className="space-y-4">
              <div>
                <Label htmlFor="bulk-file">é€‰æ‹©CSVæ–‡ä»¶</Label>
                <Input
                  id="bulk-file"
                  type="file"
                  accept=".csv"
                  onChange={(e) => setBulkUploadFile(e.target.files?.[0] || null)}
                  className="mt-2"
                />
                <p className="text-sm text-gray-500 mt-1">
                  æ”¯æŒCSVæ ¼å¼ï¼ŒåŒ…å«å•†å“åç§°ã€ç±»ç›®ã€å–ç‚¹ã€ç›®æ ‡å›½å®¶ç­‰å­—æ®µ
                </p>
              </div>
              
              {bulkUploadFile && (
                <div className="p-3 bg-gray-50 rounded-lg">
                  <p className="text-sm">
                    <strong>å·²é€‰æ‹©æ–‡ä»¶ï¼š</strong> {bulkUploadFile.name}
                  </p>
                  <p className="text-sm text-gray-600">
                    æ–‡ä»¶å¤§å°ï¼š{(bulkUploadFile.size / 1024).toFixed(1)} KB
                  </p>
                </div>
              )}

              <div className="flex justify-end space-x-2">
                <Button 
                  variant="outline" 
                  onClick={() => {
                    setShowBulkUpload(false)
                    setBulkUploadFile(null)
                  }}
                >
                  å–æ¶ˆ
                </Button>
                <Button 
                  onClick={handleBulkUpload}
                  disabled={!bulkUploadFile || bulkUploading}
                >
                  {bulkUploading ? 'ä¸Šä¼ ä¸­...' : 'å¼€å§‹ä¸Šä¼ '}
                </Button>
              </div>
            </CardContent>
          </Card>
        </div>
      )}
    </div>
  )
}

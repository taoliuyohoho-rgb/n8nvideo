# æƒé™ç³»ç»Ÿæ›´æ–°è¯´æ˜

## ğŸ“‹ æ›´æ–°æ¦‚è¿°

æœ¬æ¬¡æ›´æ–°è°ƒæ•´äº†ç³»ç»Ÿçš„æƒé™ä½“ç³»ï¼Œæ˜ç¡®åŒºåˆ†äº†**è¶…çº§ç®¡ç†å‘˜ï¼ˆsuper_adminï¼‰**å’Œ**æ™®é€šç®¡ç†å‘˜ï¼ˆadminï¼‰**çš„æƒé™ï¼š

- **è¶…çº§ç®¡ç†å‘˜ï¼ˆsuper_adminï¼‰**ï¼šæ‹¥æœ‰å®Œæ•´çš„ç³»ç»Ÿç®¡ç†æƒé™ï¼Œå¯ä»¥è®¿é—®ç®¡ç†åå°
- **æ™®é€šç®¡ç†å‘˜ï¼ˆadminï¼‰**ï¼šåªèƒ½è®¿é—®ä»ªè¡¨æ¿ï¼ˆdashboardï¼‰ï¼Œæ— æ³•è¿›å…¥ç®¡ç†åå°

## ğŸ” è´¦å·ä¿¡æ¯

### è¶…çº§ç®¡ç†å‘˜è´¦å·
```
é‚®ç®±: superadmin@126.com
å¯†ç : dongnanyaqifei
è§’è‰²: super_admin
æƒé™: å¯è®¿é—®ç®¡ç†åå° (/admin) å’Œä»ªè¡¨æ¿ (/dashboard)
```

### æ™®é€šç®¡ç†å‘˜è´¦å·
```
é‚®ç®±: admin@126.com
å¯†ç : dongnanyaqifei
è§’è‰²: admin
æƒé™: åªèƒ½è®¿é—®ä»ªè¡¨æ¿ (/dashboard)ï¼Œæ— æ³•è®¿é—®ç®¡ç†åå°
```

## ğŸ“ ä¿®æ”¹å†…å®¹

### 1. é¦–é¡µè·³è½¬é€»è¾‘ (`app/page.tsx`)

**ä¿®æ”¹å‰ï¼š**
```typescript
// ç®¡ç†å‘˜ç”¨æˆ·ç›´æ¥è·³è½¬åˆ°adminé¡µé¢
if (user.role === 'admin' || user.role === 'super_admin') {
  router.push('/admin')
}
```

**ä¿®æ”¹åï¼š**
```typescript
// åªæœ‰è¶…ç®¡å¯ä»¥è·³è½¬åˆ°adminé¡µé¢
if (user.role === 'super_admin') {
  router.push('/admin')
} else {
  // å…¶ä»–ç”¨æˆ·ï¼ˆåŒ…æ‹¬adminï¼‰è·³è½¬åˆ°dashboard
  router.push('/dashboard')
}
```

### 2. Dashboard ç®¡ç†åå°å…¥å£ (`app/dashboard/components/HomeContent.tsx`)

**ä¿®æ”¹å‰ï¼š**
```typescript
{user.role === 'admin' && (
  <Button onClick={() => window.open('/admin', '_blank')}>
    ç®¡ç†åå°
  </Button>
)}
```

**ä¿®æ”¹åï¼š**
```typescript
{user.role === 'super_admin' && (
  <Button onClick={() => window.open('/admin', '_blank')}>
    ç®¡ç†åå°
  </Button>
)}
```

### 3. ç®¡ç†åå°æƒé™æ£€æŸ¥ (`app/admin/page.tsx`)

**ä¿®æ”¹å‰ï¼š**
```typescript
// æ£€æŸ¥ç”¨æˆ·æƒé™
if (user && user.role !== 'admin' && user.role !== 'super_admin') {
  // æ˜¾ç¤ºæ— æƒé™é¡µé¢
}
```

**ä¿®æ”¹åï¼š**
```typescript
// åªæœ‰è¶…ç®¡å¯ä»¥è®¿é—®
if (user && user.role !== 'super_admin') {
  // æ˜¾ç¤ºæ— æƒé™é¡µé¢ï¼šåªæœ‰è¶…çº§ç®¡ç†å‘˜æ‰èƒ½è®¿é—®ç®¡ç†åå°
}
```

### 4. ç™»å½•æ¥å£æ›´æ–°

#### `/app/api/auth/login/route.ts`
æ–°å¢è¶…çº§ç®¡ç†å‘˜è´¦å·éªŒè¯é€»è¾‘ï¼Œä¿ç•™åŸæœ‰ç®¡ç†å‘˜è´¦å·ä½†è§’è‰²ä¸º `admin`

#### `/app/api/auth/simple-login/route.ts`
åŒæ­¥æ›´æ–°ç®€å•ç™»å½•æ¥å£çš„éªŒè¯é€»è¾‘

## ğŸ¯ æƒé™çŸ©é˜µ

| åŠŸèƒ½/é¡µé¢ | super_admin | admin | manager | operator | viewer |
|----------|-------------|-------|---------|----------|--------|
| ç™»å½•ç³»ç»Ÿ | âœ… | âœ… | âœ… | âœ… | âœ… |
| ä»ªè¡¨æ¿ (/dashboard) | âœ… | âœ… | âœ… | âœ… | âœ… |
| ç®¡ç†åå° (/admin) | âœ… | âŒ | âŒ | âŒ | âŒ |
| æŸ¥çœ‹ç®¡ç†åå°å…¥å£ | âœ… | âŒ | âŒ | âŒ | âŒ |
| æŸ¥çœ‹ç»„ç»‡ä½¿ç”¨ç»Ÿè®¡ | âœ… | âœ… | âŒ | âŒ | âŒ |
| è§†é¢‘ç”Ÿæˆ | âœ… | âœ… | âœ… | âœ… | âš ï¸ |
| å•†å“ç®¡ç† | âœ… | âœ… | âœ… | âš ï¸ | âŒ |
| AIé…ç½®ç®¡ç† | âœ… | âŒ | âŒ | âŒ | âŒ |
| ç”¨æˆ·ç®¡ç† | âœ… | âŒ | âŒ | âŒ | âŒ |
| Promptç®¡ç† | âœ… | âŒ | âŒ | âŒ | âŒ |
| äººè®¾ç®¡ç† | âœ… | âŒ | âŒ | âŒ | âŒ |

> âš ï¸ è¡¨ç¤ºéƒ¨åˆ†æƒé™ï¼ˆå¦‚åªè¯»æˆ–å—é™æ“ä½œï¼‰

## ğŸ§ª æµ‹è¯•æ­¥éª¤

### æµ‹è¯• 1: è¶…çº§ç®¡ç†å‘˜ç™»å½•
1. è®¿é—® `http://localhost:3000/login`
2. ä½¿ç”¨è¶…ç®¡è´¦å·ç™»å½•ï¼š`superadmin@126.com` / `dongnanyaqifei`
3. **é¢„æœŸç»“æœ**ï¼š
   - è‡ªåŠ¨è·³è½¬åˆ° `/admin` ç®¡ç†åå°
   - å¯ä»¥çœ‹åˆ°æ‰€æœ‰ç®¡ç†åŠŸèƒ½æ ‡ç­¾é¡µ
   - å¯ä»¥æ­£å¸¸ä½¿ç”¨æ‰€æœ‰åŠŸèƒ½

### æµ‹è¯• 2: æ™®é€šç®¡ç†å‘˜ç™»å½•
1. è®¿é—® `http://localhost:3000/login`
2. ä½¿ç”¨adminè´¦å·ç™»å½•ï¼š`admin@126.com` / `dongnanyaqifei`
3. **é¢„æœŸç»“æœ**ï¼š
   - è‡ªåŠ¨è·³è½¬åˆ° `/dashboard` ä»ªè¡¨æ¿
   - **çœ‹ä¸åˆ°**"ç®¡ç†åå°"æŒ‰é’®
   - å¯ä»¥æ­£å¸¸ä½¿ç”¨ä»ªè¡¨æ¿æ‰€æœ‰åŠŸèƒ½
   - å¯ä»¥æŸ¥çœ‹ç»„ç»‡ä½¿ç”¨ç»Ÿè®¡

### æµ‹è¯• 3: ç›´æ¥è®¿é—®ç®¡ç†åå°ï¼ˆadminè´¦å·ï¼‰
1. ä½¿ç”¨adminè´¦å·ç™»å½•å
2. æ‰‹åŠ¨è®¿é—® `http://localhost:3000/admin`
3. **é¢„æœŸç»“æœ**ï¼š
   - æ˜¾ç¤º"æ— æƒé™è®¿é—®"é¡µé¢
   - æç¤º"åªæœ‰è¶…çº§ç®¡ç†å‘˜æ‰èƒ½è®¿é—®ç®¡ç†åå°"
   - è‡ªåŠ¨é‡å®šå‘åˆ°é¦–é¡µ

### æµ‹è¯• 4: æœªç™»å½•è®¿é—®
1. æ¸…é™¤æµè§ˆå™¨localStorageä¸­çš„ç”¨æˆ·ä¿¡æ¯
2. è®¿é—® `http://localhost:3000/admin`
3. **é¢„æœŸç»“æœ**ï¼š
   - æ£€æµ‹åˆ°æœªç™»å½•
   - è‡ªåŠ¨é‡å®šå‘åˆ°ç™»å½•é¡µé¢

## ğŸ”„ å›æ»šæ–¹æ¡ˆ

å¦‚æœéœ€è¦å›æ»šåˆ°ä¹‹å‰çš„æƒé™ç³»ç»Ÿï¼ˆadminä¹Ÿå¯ä»¥è®¿é—®ç®¡ç†åå°ï¼‰ï¼Œä¿®æ”¹ä»¥ä¸‹æ–‡ä»¶ï¼š

1. `app/page.tsx`: å°† `user.role === 'super_admin'` æ”¹å› `user.role === 'admin' || user.role === 'super_admin'`
2. `app/dashboard/components/HomeContent.tsx`: å°† `user.role === 'super_admin'` æ”¹å› `user.role === 'admin'`
3. `app/admin/page.tsx`: å°†ä¸¤å¤„ `user.role !== 'super_admin'` æ”¹å› `user.role !== 'admin' && user.role !== 'super_admin'`

## ğŸ“Œ æ³¨æ„äº‹é¡¹

1. **æ•°æ®åº“roleå­—æ®µ**ï¼šç¡®ä¿æ•°æ®åº“ä¸­ç”¨æˆ·çš„ `role` å­—æ®µæ­£ç¡®è®¾ç½®ä¸º `super_admin` æˆ– `admin`
2. **ç¯å¢ƒå˜é‡**ï¼šæƒé™æ£€æŸ¥ä¸ä¾èµ–ç¯å¢ƒå˜é‡ï¼Œç›´æ¥ä»ç”¨æˆ·æ•°æ®çš„ `role` å­—æ®µåˆ¤æ–­
3. **å‰åç«¯ä¸€è‡´æ€§**ï¼šå‰ç«¯è·¯ç”±å’ŒUIæ˜¾ç¤ºéƒ½åŸºäºlocalStorageä¸­çš„ç”¨æˆ·roleï¼Œä¸åç«¯APIæƒé™ä¿æŒä¸€è‡´
4. **å®‰å…¨æ€§**ï¼šé‡è¦çš„åç«¯APIï¼ˆå¦‚ `/api/admin/*`ï¼‰åº”è¯¥ä¹ŸåŠ ä¸Šæƒé™æ£€æŸ¥ä¸­é—´ä»¶ï¼ˆåç»­å¾…å®Œå–„ï¼‰

## ğŸš€ åç»­ä¼˜åŒ–å»ºè®®

1. **ç»Ÿä¸€æƒé™ä¸­é—´ä»¶**ï¼šåˆ›å»ºä¸€ä¸ªç»Ÿä¸€çš„æƒé™æ£€æŸ¥ä¸­é—´ä»¶ï¼Œç”¨äºæ‰€æœ‰ç®¡ç†åå°API
2. **æƒé™æšä¸¾**ï¼šå°†è§’è‰²åç§°æ”¹ä¸ºæšä¸¾ç±»å‹ï¼Œé¿å…å­—ç¬¦ä¸²ç¡¬ç¼–ç 
3. **ç»†ç²’åº¦æƒé™**ï¼šè€ƒè™‘å®ç°åŸºäºèµ„æºå’Œæ“ä½œçš„RBACæƒé™ç³»ç»Ÿ
4. **æƒé™é…ç½®åŒ–**ï¼šå°†æƒé™çŸ©é˜µé…ç½®åŒ–ï¼Œä¾¿äºçµæ´»è°ƒæ•´
5. **å®¡è®¡æ—¥å¿—**ï¼šè®°å½•æ‰€æœ‰æƒé™ç›¸å…³çš„æ“ä½œæ—¥å¿—ï¼Œä¾¿äºè¿½æº¯

## ğŸ“… æ›´æ–°æ—¥æœŸ

2025å¹´10æœˆ31æ—¥


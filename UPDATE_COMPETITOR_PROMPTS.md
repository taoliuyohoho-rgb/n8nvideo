# 竞品分析Prompt模板更新

## 更新说明

原有的竞品分析Prompt模板存在以下问题：
1. 假设输入是URL，但实际场景是用户直接复制详情页描述或粘贴图片
2. Prompt太泛化，没有强调商品个性化信息
3. 输出格式不符合实际需求（只需要卖点，不需要痛点）

## 新的默认Prompt模板（已在API中实现）

```javascript
const defaultPrompt = `# 任务
你是资深跨境电商运营专家。基于下方的**竞品详情页内容**（文本或图片），为我们的商品提取新的卖点。

# 我们的商品信息
**商品名称**: ${product.name}
**所属类目**: ${product.category}
**目标市场**: ${product.targetCountries?.join(', ') || '东南亚'}

**已有卖点**（请避免重复）:
${product.sellingPoints.length > 0 ? product.sellingPoints.map((sp, i) => `${i + 1}. ${sp.point}`).join('\n') : '暂无'}

# 竞品详情页内容
${competitorText || '（见图片）'}

# 输出要求
严格按以下JSON格式输出，只输出JSON，不要任何解释：

{
  "sellingPoints": [
    "针对${product.name}提取的卖点1（10-25字）",
    "针对${product.name}提取的卖点2（10-25字）",
    "..."
  ]
}

**注意事项**：
1. 卖点必须适用于"${product.name}"这个商品，不要泛化
2. 从竞品内容中提取，但表述为适合我们商品的卖点
3. 每个卖点10-25字，简洁有力
4. 与已有卖点去重，提供新的角度
5. 只基于输入证据，不得臆造
6. 至少提取3-8个卖点`
```

## 关键改进点

### 1. **去掉URL假设**
- 之前：`竞品URL：{{competitorUrl}}`
- 现在：`竞品详情页内容：${competitorText || '（见图片）'}`
- **原因**：用户直接复制粘贴，不是输入URL

### 2. **强化商品个性化**
- 明确注入商品名称：`${product.name}`
- 在Prompt中多次强调：`针对${product.name}提取的卖点`
- 提供商品上下文：类目、目标市场、已有卖点
- **原因**：避免AI产出泛化的卖点

### 3. **已有卖点展示**
```javascript
${product.sellingPoints.length > 0 
  ? product.sellingPoints.map((sp, i) => `${i + 1}. ${sp.point}`).join('\n') 
  : '暂无'}
```
- 带编号列表展示
- AI可以看到已有的，避免重复
- **原因**：去重在数据库层面和AI层面双重保证

### 4. **输出格式简化**
- 只要 `sellingPoints` 数组
- 去掉痛点、视觉风格等不需要的字段
- **原因**：聚焦核心需求，提高成功率

### 5. **字数要求明确**
- 每个卖点：10-25字
- 至少3-8个卖点
- **原因**：太短没有信息量，太长不够简洁

## 实际使用流程

```
用户操作                          系统处理
   │
   ├─ 打开竞品分析弹窗           
   │
   ├─ 复制竞品详情页描述          ─> 粘贴到文本框
   │  或粘贴图片                  ─> 显示缩略图
   │
   ├─ 失焦（点击空白处）          ─> 触发推荐刷新
   │                              ├─ 推荐AI模型（如 openai/gpt-4o-mini）
   │                              └─ 推荐Prompt模板（标准版）
   │
   ├─ 点击"开始分析"              ─> 调用 /api/competitor/analyze
   │                              ├─ 获取商品信息（name, category, sellingPoints等）
   │                              ├─ 构建个性化Prompt（注入商品信息）
   │                              ├─ 调用AI（支持文本+图片）
   │                              ├─ 解析JSON结果
   │                              ├─ 去重（与已有卖点对比）
   │                              └─ 保存到数据库
   │
   └─ 显示结果                    ─> 提示："新增卖点 5 个"
```

## 代码位置

### 主要实现
- **API**: `/app/api/competitor/analyze/route.ts`
  - 第48-79行：默认Prompt定义
  - 第110-128行：卖点去重与保存逻辑

### 待更新（可选）
- **Prompt模板库**: `/app/api/admin/prompts/init-defaults/route.ts`
  - 第115-209行：5个竞品分析模板
  - 建议更新为与API默认Prompt一致的风格

## 测试建议

### 场景1：纯文本输入
```
输入：复制某个电磁炉的详情页描述
预期：提取3-8个适合本商品的卖点
```

### 场景2：图片输入
```
输入：粘贴竞品详情页截图
预期：AI识别图片内容，提取卖点
```

### 场景3：文本+图片
```
输入：既有文本描述又有图片
预期：综合分析，提取更全面的卖点
```

### 场景4：去重验证
```
前提：商品已有卖点："高效节能"
输入：竞品描述也强调节能
预期：AI提取的"节能"卖点会被数据库去重逻辑过滤
```

## 后续优化方向

1. **多语言支持**：根据目标市场调整卖点表述
2. **情感驱动**：强调情感共鸣的卖点（安全感、成就感等）
3. **差异化强调**：突出与竞品的差异点
4. **A/B测试**：测试不同Prompt风格的效果
5. **反馈循环**：基于卖点使用效果（点击率、转化率）优化Prompt



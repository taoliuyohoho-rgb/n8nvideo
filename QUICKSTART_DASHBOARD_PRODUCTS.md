# 🚀 工作台商品管理快速上手

## 问题已解决 ✅

**原问题**: 工作台的商品管理点击页面报错  
**解决方案**: 工作台现在直接使用管理后台的完整商品库，两边信息同步

## 快速开始

### 1. 启动项目
```bash
npm run dev
```

### 2. 访问工作台
打开浏览器访问：`http://localhost:3000/dashboard`

### 3. 使用商品管理

#### 进入商品管理
- 在左侧菜单点击 **"商品管理"** 图标

#### 查看商品列表
- 自动显示所有商品
- 支持搜索、筛选、排序

#### 添加新商品
1. 点击右上角 **"添加商品"** 按钮
2. 填写商品信息：
   - 商品名称（必填）
   - 商品描述
   - 选择类目和二级类目
   - 添加卖点（可添加多个）
   - 选择目标国家
   - 添加目标受众
   - 添加痛点（可选）
3. 点击 **"保存"** 按钮
4. 看到成功提示，商品列表自动刷新

#### 编辑商品
1. 在商品卡片上点击 **"编辑"** 按钮（铅笔图标）
2. 修改商品信息
3. 点击 **"更新"** 按钮
4. 看到成功提示

#### 删除商品
1. 在商品卡片上点击 **"删除"** 按钮（垃圾桶图标）
2. 确认删除操作
3. 商品从列表中移除

#### 批量上传商品
1. 点击 **"批量上传"** 按钮
2. 选择 Excel 或 CSV 文件
3. 点击 **"上传"** 按钮
4. 等待处理完成
5. 看到成功提示，显示处理的记录数

#### 商品分析
1. 选择要分析的商品（点击复选框）
2. 点击 **"商品分析"** 按钮
3. 查看分析结果

#### 配置管理
1. 点击 **"配置"** 按钮（齿轮图标）
2. 管理类目、二级类目、目标国家
3. 添加或删除配置项
4. 关闭对话框自动保存

## 功能特性

### ✅ 完整功能
- 商品列表展示（卡片式）
- 搜索商品（按名称或描述）
- 筛选商品（按类目）
- 排序（按名称、创建时间、更新时间）
- 添加新商品
- 编辑商品信息
- 删除商品
- 批量上传商品
- 商品分析
- 配置管理

### 🔒 权限控制
所有操作都经过权限检查，不同角色有不同权限：
- **super_admin**: 所有权限，可查看所有商品（跨组织）
- **admin**: 完整权限，只能查看自己组织的商品
- **operator**: 受限权限，只能查看自己组织的商品，只能编辑痛点/卖点/目标受众，不能添加/删除商品和批量上传

### 🔄 数据同步
- 工作台和管理后台使用同一个商品库
- 在任何一边做的更改，另一边刷新后都能看到
- 数据实时同步，无需手动同步

## 界面说明

### 顶部操作栏
- **商品分析**: 分析选中的商品
- **添加商品**: 打开添加商品表单

### 搜索和筛选区域
- **搜索框**: 输入商品名称或描述搜索
- **商品分类**: 下拉选择商品类目
- **排序字段**: 选择排序依据
- **排序顺序**: 升序或降序

### 商品卡片
每个商品卡片显示：
- 商品名称和描述
- 类目标签
- 创建时间
- 卖点预览
- 目标受众预览
- 操作按钮（编辑、删除）

### 通知提示
- **成功**: 绿色背景
- **错误**: 红色背景
- **信息**: 蓝色背景
- 自动在 3 秒后消失，或点击 ✕ 手动关闭

## 验证数据同步

### 测试步骤
1. **在工作台添加商品**
   ```
   访问 http://localhost:3000/dashboard
   → 商品管理
   → 添加商品
   → 填写信息并保存
   ```

2. **在管理后台查看**
   ```
   访问 http://localhost:3000/admin
   → 商品管理
   → 应该看到刚刚添加的商品
   ```

3. **在管理后台编辑**
   ```
   在管理后台编辑该商品
   → 保存修改
   ```

4. **在工作台查看**
   ```
   回到工作台
   → 刷新页面或点击刷新按钮
   → 应该看到更新后的信息
   ```

## 常见问题

### Q: 提示"权限不足"怎么办？
A: 检查当前登录用户的角色。某些操作需要 admin 或 super_admin 权限。

### Q: 商品操作后列表没有刷新？
A: 点击刷新按钮，或者页面会自动重载。

### Q: 看不到其他人添加的商品？
A: 这是正常的。商品按 organizationId 隔离，用户只能看到自己组织的商品。

### Q: 批量上传失败？
A: 检查文件格式（Excel 或 CSV）和数据格式是否正确。

### Q: 如何访问管理后台？
A: 访问 `http://localhost:3000/admin`（需要 admin 或 super_admin 角色）

## 技术细节

### API 端点
- `GET /api/products` - 获取商品列表
- `POST /api/products` - 创建商品
- `PUT /api/products/[id]` - 更新商品
- `DELETE /api/products/[id]` - 删除商品

### 权限检查
所有 API 端点都集成了 `PermissionService`：
- 检查用户身份
- 验证操作权限
- 过滤组织数据

### 数据隔离
- 基于 `organizationId` 的数据过滤
- 用户只能访问自己组织的商品
- 确保数据安全

## 下一步

- ✅ 工作台商品管理已完全可用
- ✅ 与管理后台完全同步
- ✅ 权限管理已实施

现在可以：
1. 测试所有功能
2. 添加真实商品数据
3. 在视频生成流程中使用商品

## 相关文档

- [详细实现文档](./DASHBOARD_PRODUCT_INTEGRATION.md)
- [完成总结](./DASHBOARD_PRODUCT_SYNC_SUMMARY.md)
- [工作台访问指南](./DASHBOARD_ACCESS.md)

---

**更新日期**: 2025-10-29  
**状态**: ✅ 可用

